<!DOCTYPE html><html  data-capo=""><head><meta charset="utf-8">
<meta name="viewport" content="width=device-width, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>组件应在什么嵌套级别从Flux商店读取实体？ - Winter100</title>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-KZ1S1HBYLX"></script>
<link rel="stylesheet" type="text/css" href="/iconfont/iconfont.css?t=20240930">
<link rel="stylesheet" href="/_nuxt/entry.FjTWphKN.css">
<link rel="stylesheet" href="/_nuxt/default.CerbM5oS.css">
<link rel="stylesheet" href="/_nuxt/Main.DNckYZCw.css">
<link rel="stylesheet" href="/_nuxt/Discuss.B5xG6lk2.css">
<link rel="stylesheet" href="/_nuxt/NewList.B56uyASM.css">
<link rel="stylesheet" href="/_nuxt/all.Be8c8_k3.css">
<link rel="preload" as="fetch" crossorigin="anonymous" href="/question/1297/_payload.json?e77a6ad3-63a8-427f-9459-00571a6cdc19">
<script src="/_nuxt/CrQvFcQD-legacy.js" nomodule crossorigin></script>
<script src="/_nuxt/CpJo3Ge4-legacy.js" nomodule crossorigin></script>
<link rel="icon" type="image/x-icon" href="/favicon.ico">
<script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());

gtag('config', 'G-KZ1S1HBYLX');
</script>
<meta property="og:title" content="组件应在什么嵌套级别从Flux商店读取实体？ - Winter100">
<meta name="description" content="我正在重写我的应用程序以使用Flux，但从商店检索数据时遇到问题。我有很多组件，它们嵌套很多。其中有些是大（Article），有些是小而简单（UserAv...">
<meta property="og:description" content="我正在重写我的应用程序以使用Flux，但从商店检索数据时遇到问题。我有很多组件，它们嵌套很多。其中有些是大（Article），有些是小而简单（UserAv...">
<meta property="og:image" content>
<meta name="twitter:card" content="summary_large_image">
<script type="module" src="/_nuxt/-5XrV3z5.js" crossorigin></script></head><body><div id="el-popper-container-1024"><!--teleport start anchor--><!--[--><div style="z-index:2001;position:absolute;left:0;top:0;width:120px;display:none;" class="el-popper is-light el-popover c-lang-legal-popover" tabindex="-1" aria-hidden="true"><!--[--><!--[--><!--[--><!--[--><!--v-if--><!--[--><div class="c-lang-legal-box"><div class="c-contain"><ul class="c-list"><!--[--><li class="item-list list-item-active"><img src="/images/cn.svg" class="mr-12"><div class="flex-shrink-0">简体中文</div></li><li class="item-list false"><img src="/images/cn.svg" class="mr-12"><div class="flex-shrink-0">繁体中文</div></li><li class="item-list false"><img src="/images/en.svg" class="mr-12"><div class="flex-shrink-0">English</div></li><!--]--></ul></div></div><!--]--><!--]--><span class="el-popper__arrow" style="position:absolute;" data-popper-arrow></span><!--]--><!--]--><!--]--></div><!--]--><!--teleport anchor--><!--teleport start anchor--><!--[--><!--v-if--><!--]--><!--teleport anchor--><!--teleport start anchor--><!--[--><!--v-if--><!--]--><!--teleport anchor--></div><div id="__nuxt"><!--[--><section class="el-container is-vertical l-home"><!--[--><div class="nuxt-loading-indicator" style="position:fixed;top:0;right:0;left:0;pointer-events:none;width:auto;height:3px;opacity:0;background:repeating-linear-gradient(to right,#00dc82 0%,#34cdfe 50%,#0047e1 100%);background-size:Infinity% auto;transform:scaleX(0%);transform-origin:left;transition:transform 0.1s, height 0.4s, opacity 0.4s;z-index:999999;"></div><!--[--><!----><!--]--><!--[--><!----><!--]--><div class="c-common-header"><header class="el-header c-common-header-inner" style=""><!--[--><a href="/" class="flex space-x-8 items-center"><div class="sub-logo"><svg t="1696732448231" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="6740" xmlns:xlink="http://www.w3.org/1999/xlink" width="30" height="30"><defs><linearGradient id="left-to-right"><stop offset="0" stop-color="#ed3da1"><animate dur="3s" attributeName="offset" fill="freeze" values="-1;2;0" repeatCount="indefinite"></animate></stop><stop offset="0" stop-color="#ffe9f6"><animate dur="3s" attributeName="offset" fill="freeze" values="-1;2;0" repeatCount="indefinite"></animate></stop></linearGradient></defs><path d="M105.321374 914.265136c-11.700669 0-17.551004-11.702475-17.551003-17.541972 0-5.870203 5.850335-17.551004 11.7097-17.551004 269.155125-111.194286 561.722425-169.684988 848.441196-181.3983v5.839497c23.410369 0 52.662042-5.839497 76.076024-5.839497v11.711506c-292.558269 29.251673-579.284266 87.756824-854.300562 175.535323-17.551004 17.541972-40.964985 23.403144-64.375355 29.244447zM772.382332 580.741882c-29.260704 0-58.514183-5.861172-76.054349-29.240835-17.55281-23.412175-35.123682-46.826157-35.123681-76.079636 0-81.917327 23.403144-157.984319 76.068798-222.350642 46.835188-64.377161 117.042815-111.168999 193.106195-140.433316 29.251673 0 52.654817 17.563647 64.368129 40.954148-5.862978 5.850335-11.711506 11.711506-17.563647 11.711506 29.251673 11.700669 40.952342 35.102007 40.952342 64.366324 5.862978 163.834654-99.459299 310.121916-245.753787 351.072451z m157.996963-374.484627c-11.702475 5.850335-29.273347 17.551004-40.954148 29.264316-5.870203 0-5.870203-5.850335-5.870203-11.711506-87.778499 52.665654-146.281844 146.294487-152.114116 245.742949 0 11.711506 5.832272 52.665654 23.38147 46.835188 29.284184-11.7097 52.662042-23.423013 70.225688-46.835188 19.503523-21.441593 39.00524-42.894024 58.506958-64.344648 35.121876-46.81532 58.535857-105.320471 70.216658-163.847297 11.700669-17.55281-5.848528-29.253479-23.392307-35.103814zM122.872378 288.185419l-64.366323 29.251673c-5.839497 5.839497-11.689832 5.839497-17.540167 5.839497-5.862978 0-5.862978-11.713313-5.862978-17.540166 0-17.551004 11.713313-29.264316 29.273347-35.114651 35.103813-29.264316 70.20582-52.654817 111.158163-70.216657 17.551004 5.850335 29.264316 23.403144 35.11465 40.952341 0 17.540166 0 17.540166-81.919133 204.812282-29.249866 58.505151-52.651204 122.873281-58.523213 187.237798 0 5.852141 5.872009 17.55281 5.872009 23.412176v5.841303c-1.959745 1.948907-3.910458 3.912264-5.872009 5.861172-5.830466 0-11.700669 0-11.700669-5.861172-29.253479 0-52.663848-17.55281-58.505152-46.804482 0-46.813513 11.711506-99.470137 29.251673-140.433316 23.413982-64.366323 58.517795-122.871475 93.619802-187.237798zM637.792126 282.326054c11.700669 157.984319-87.760436 298.417635-239.892614 339.380813-29.264316 0-58.515989-5.850335-76.07783-29.264316-23.401338-17.561841-35.092976-46.813513-35.092976-76.056155 0-81.926358 23.403144-157.99335 76.068798-222.359673 46.804482-64.355486 117.008497-111.159968 193.086327-140.433316 29.242642 0 52.665654 17.551004 64.368129 40.975823-5.852141 5.839497-11.702475 11.689832-17.55281 11.689832 17.551004 17.549197 35.092976 46.811707 35.092976 76.066992z m-81.908295-35.103814c-11.7097 5.850335-29.260704 17.551004-40.963179 29.251673-5.850335 0-5.850335-5.850335-5.850335-11.700669-87.769468 52.665654-146.272813 146.28365-152.135791 245.762818 0 11.680801 5.862978 52.663848 23.413982 46.793645 29.251673-11.702475 52.665654-23.403144 70.20582-46.793645a140273.571944 140273.571944 0 0 0 58.515989-64.366324c35.103813-46.826157 58.514183-105.320471 70.214852-163.84549 11.713313-17.551004-5.839497-29.253479-23.401338-35.102008zM23.414885 808.944665c269.155125-111.170806 561.711587-169.684988 848.437584-181.3983v5.859365c29.251673 0 52.665654-5.859366 76.068798-5.859365v11.711506c-292.558269 29.26251-579.287878 87.778499-854.302368 175.544354-23.413982 11.713313-40.954148 17.554616-64.36813 23.3905h-5.837691c-5.872009 0-11.702475-5.835885-11.702475-17.551003 3.903233-3.896009 7.804661-7.797436 11.704282-11.697057z" fill="url(#left-to-right)" p-id="6741" class="logo-path"></path></svg></div><img class="h-40" src="/logo.svg"></a><div class="nav-items"><!--[--><!--[--><a href="/" class="nav-item">首页</a><!--]--><!--[--><a href="/question" class="nav-item active">问答</a><!--]--><!--[--><a href="/blog" class="nav-item">博客</a><!--]--><!--[--><a href="/about" class="nav-item">关于</a><!--]--><!--[--><a href="/message" class="nav-item">留言</a><!--]--><!--[--><a class="nav-item" target="_blank" rel="noopener noreferrer" href="https://tools.winter100.com">工具箱</a><!--]--><!--]--></div><div class="flex-1"></div><div class="c-lang-legal xs:hidden"><!--[--><span class="relative ml-32 inline-flex items-center cursor-pointer border-gray-06 border px-8 py-4 rounded-8 el-tooltip__trigger el-tooltip__trigger"><img src="/images/cn.svg" class="mr-8"> 简体中文 <i class="el-icon ml-4 text-12" style=""><!--[--><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1024 1024"><path fill="currentColor" d="m192 384 320 384 320-384z"></path></svg><!--]--></i></span><!--teleport start--><!--teleport end--><!--]--></div><i class="iconfont icon-caidan text-theme hover:opacity-70 text-28 hidden xs:block"></i><!--]--></header><!----></div><main class="l-default-home"><!--[--><div class="c-question-main"><div class="page-container pt-30 pb-60"><div class="c-outer"><div class="article-area"><h1 class="article-title">组件应在什么嵌套级别从Flux商店读取实体？</h1><p class="article-meta" style="color:#8590a6;"><span>小小</span><i class="iconfont icon-time text-12 ml-12"></i><span>2020-03-12</span></p><div class="article-content code-content"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">我正在重写我的应用程序以使用Flux，但从商店检索数据时遇到问题。</font><font style="vertical-align: inherit;">我有很多组件，它们嵌套很多。</font><font style="vertical-align: inherit;">其中有些是大（</font></font><code>Article</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">），有些是小而简单（</font></font><code>UserAvatar</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，</font></font><code>UserLink</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）。</font></font></p>

<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">我一直在努力在组件层次结构中的哪些位置应该从商店读取数据。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
我尝试了两种极端的方法，但我都不喜欢：</font></font></p>

<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">所有实体组件都读取自己的数据</font></font></h2>

<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">需要从Store获得一些数据的每个组件仅接收实体ID，并自行检索实体。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
例如，</font></font><code>Article</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">被传递</font></font><code>articleId</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，</font></font><code>UserAvatar</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">并</font></font><code>UserLink</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">传递</font></font><code>userId</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font></p>

<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">这种方法有几个明显的缺点（在代码示例下讨论）。</font></font></p>

<pre><code>var Article = React.createClass({<font></font>
  mixins: [createStoreMixin(ArticleStore)],<font></font>
<font></font>
  propTypes: {<font></font>
    articleId: PropTypes.number.isRequired<font></font>
  },<font></font>
<font></font>
  getStateFromStores() {<font></font>
    return {<font></font>
      article: ArticleStore.get(this.props.articleId);<font></font>
    }<font></font>
  },<font></font>
<font></font>
  render() {<font></font>
    var article = this.state.article,<font></font>
        userId = article.userId;<font></font>
<font></font>
    return (<font></font>
      &lt;div&gt;<font></font>
        &lt;UserLink userId={userId}&gt;<font></font>
          &lt;UserAvatar userId={userId} /&gt;<font></font>
        &lt;/UserLink&gt;<font></font>
<font></font>
        &lt;h1&gt;{article.title}&lt;/h1&gt;<font></font>
        &lt;p&gt;{article.text}&lt;/p&gt;<font></font>
<font></font>
        &lt;p&gt;Read more by &lt;UserLink userId={userId} /&gt;.&lt;/p&gt;<font></font>
      &lt;/div&gt;<font></font>
    )<font></font>
  }<font></font>
});<font></font>
<font></font>
var UserAvatar = React.createClass({<font></font>
  mixins: [createStoreMixin(UserStore)],<font></font>
<font></font>
  propTypes: {<font></font>
    userId: PropTypes.number.isRequired<font></font>
  },<font></font>
<font></font>
  getStateFromStores() {<font></font>
    return {<font></font>
      user: UserStore.get(this.props.userId);<font></font>
    }<font></font>
  },<font></font>
<font></font>
  render() {<font></font>
    var user = this.state.user;<font></font>
<font></font>
    return (<font></font>
      &lt;img src={user.thumbnailUrl} /&gt;<font></font>
    )<font></font>
  }<font></font>
});<font></font>
<font></font>
var UserLink = React.createClass({<font></font>
  mixins: [createStoreMixin(UserStore)],<font></font>
<font></font>
  propTypes: {<font></font>
    userId: PropTypes.number.isRequired<font></font>
  },<font></font>
<font></font>
  getStateFromStores() {<font></font>
    return {<font></font>
      user: UserStore.get(this.props.userId);<font></font>
    }<font></font>
  },<font></font>
<font></font>
  render() {<font></font>
    var user = this.state.user;<font></font>
<font></font>
    return (<font></font>
      &lt;Link to='user' params={{ userId: this.props.userId }}&gt;<font></font>
        {this.props.children || user.name}<font></font>
      &lt;/Link&gt;<font></font>
    )<font></font>
  }<font></font>
});<font></font>
</code></pre>

<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">这种方法的缺点：</font></font></p>

<ul>
<li>It's frustrating to have 100s components potentially subscribing to Stores;</li>
<li>It's <strong>hard to keep track of how data is updated and in what order</strong> because each component retrieves its data independently;</li>
<li>Even though you might <em>already</em> have an entity in state, you are forced to pass its ID to children, who will retrieve it again (or else break the consistency).</li>
</ul>

<h2>All data is read once at the top level and passed down to components</h2>

<p>When I was tired of tracking down bugs, I tried to put all data retrieving at the top level. This, however, proved impossible because for some entities I have several levels of nesting.</p>

<p>For example:</p>

<ul>
<li>A <code>Category</code> contains <code>UserAvatar</code>s of people who contribute to that category;</li>
<li>An <code>Article</code> may have several <code>Category</code>s.</li>
</ul>

<p>Therefore if I wanted to retrieve all data from Stores at the level of an <code>Article</code>, I would need to:</p>

<ul>
<li>Retrieve article from <code>ArticleStore</code>;</li>
<li>Retrieve all article's categories from <code>CategoryStore</code>;</li>
<li>Separately retrieve each category's contributors from <code>UserStore</code>;</li>
<li>Somehow pass all that data down to components.</li>
</ul>

<p>Even more frustratingly, whenever I need a deeply nested entity, I would need to add code to each level of nesting to additionally pass it down.</p>

<h2>Summing Up</h2>

<p>Both approaches seem flawed. How do I solve this problem most elegantly?</p>

<p>My objectives:</p>

<ul>
<li><p>Stores shouldn't have an insane number of subscribers. It's stupid for each <code>UserLink</code> to listen to <code>UserStore</code> if parent components already do that.</p></li>
<li><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果父组件已经从存储中检索到某个对象（例如</font></font><code>user</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">），我不希望任何嵌套的组件都必须再次获取它。</font><font style="vertical-align: inherit;">我应该能够通过道具传递它。</font></font></p></li>
<li><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">我不必在顶层获取所有实体（包括关系），因为这会使添加或删除关系复杂化。</font><font style="vertical-align: inherit;">我不想每次嵌套实体获得新关系（例如category获得</font></font><code>curator</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）</font><font style="vertical-align: inherit;">时都在所有嵌套级别引入新道具</font><font style="vertical-align: inherit;">。</font></font></p></li>
</ul></div></div><div class="mt-20"><div class="discuss-wrapper"><div class="discuss-list"><!--[--><div class="discuss-item"><div class="discuss-parent"><div class="discuss-meta"><span class="discuss-user">十三Davaid</span><span class="discuss-time">2020/03/12 18:15:54</span></div><div class="discuss-comment"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">我的解决方案要简单得多。</font><font style="vertical-align: inherit;">每个具有自己状态的组件都可以交谈和收听商店。</font><font style="vertical-align: inherit;">这些是非常类似于控制器的组件。</font><font style="vertical-align: inherit;">不允许嵌套更深层的嵌套组件，这些组件不能保持状态，而只能渲染内容。</font><font style="vertical-align: inherit;">他们仅收到用于纯渲染的道具，非常类似于视图。</font></font></p>

<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">这样，一切都从有状态组件流入无状态组件。</font><font style="vertical-align: inherit;">保持状态计数低。</font></font></p>

<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在您的情况下，Article将是有状态的，因此仅与商店和UserLink等进行对话，因此它将接收article.user作为道具。 </font></font></p></div><!----></div></div><div class="discuss-item"><div class="discuss-parent"><div class="discuss-meta"><span class="discuss-user">Eva</span><span class="discuss-time">2020/03/12 18:15:54</span></div><div class="discuss-comment"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">您的2种方法中描述的问题对于任何单页应用程序都是常见的。</font></font></p>

<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在此视频中简要讨论了它们：</font></font><a href="https://www.youtube.com/watch?v=IrgHurBjQbg" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">https</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : </font><a href="https://www.youtube.com/watch?v=IrgHurBjQbg" rel="nofollow"><font style="vertical-align: inherit;">//www.youtube.com/watch?v=IrgHurBjQbg</font></a><font style="vertical-align: inherit;">和Relay（</font></font><a href="https://facebook.github.io/relay" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">https://facebook.github.io/relay</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）是Facebook开发的，目的是克服您描述的折衷。</font></font></p>

<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">中继的方法</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">非常</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">以数据为中心。</font><font style="vertical-align: inherit;">它是对以下问题的答案：“如何通过对服务器的一次查询，仅获取该视图中每个组件的所需数据？” </font><font style="vertical-align: inherit;">同时，当一个组件在多个视图中使用时，Relay确保您在代码之间几乎没有耦合。</font></font></p>

<p><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果不是Relay的选择</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，那么针对您所描述的情况，“所有实体组件都读取其自己的数据”似乎是更好的方法。</font><font style="vertical-align: inherit;">我认为Flux的误解是一家商店。</font><font style="vertical-align: inherit;">存储的概念不应该是保留模型或对象集合的地方。</font><font style="vertical-align: inherit;">商店是应用程序在呈现视图之前将数据放入其中的临时位置。</font><font style="vertical-align: inherit;">它们存在的真正原因是为了解决跨不同存储的数据之间的依赖性问题。</font></font></p>

<p>What Flux is not specifying is how a store relate to the concept of models and collection of objects (a la Backbone).
In that sense some people are actually making a flux store a place where to put collection of objects of a specific type that is not flush for the whole time the user keeps the browser open but, as I understand flux, that is not what a store is supposed to be.</p>

<p>The solution is to have another layer where you where the entities necessary to render your view (and potentially more) are stored and kept updated. If you this layer that abstract models and collections, it is not a problem if you the subcomponents have to query again to get their own data. </p></div><!----></div></div><div class="discuss-item"><div class="discuss-parent"><div class="discuss-meta"><span class="discuss-user">理查德阳光</span><span class="discuss-time">2020/03/12 18:15:54</span></div><div class="discuss-comment"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">大多数人是从在层级顶部附近的控制器视图组件中收听相关商店开始的。  </font></font></p>

<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">后来，当似乎许多无关的道具通过层次结构向下传递到某个深层嵌套的组件时，</font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">有些人</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">会认为让一个更深的组件侦听商店中的更改是个好主意。</font><font style="vertical-align: inherit;">这样可以更好地封装问题域，而组件树的这个更深层次的分支就是这个问题域。</font><font style="vertical-align: inherit;">要明智地进行此操作，有很多理由。</font></font></p>

<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">但是，我更喜欢始终在最上面听，并简单地传递所有数据。</font><font style="vertical-align: inherit;">有时，我什至会考虑存储的整个状态，并将其作为单个对象向下传递到层次结构中，而我将对多个存储执行此操作。</font><font style="vertical-align: inherit;">因此，我将为</font></font><code>ArticleStore</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">的状态</font><font style="vertical-align: inherit;">提供一个支持，为</font><font style="vertical-align: inherit;">的状态</font><font style="vertical-align: inherit;">提供一个支持</font></font><code>UserStore</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，等等。我发现避免深度嵌套的控制器视图将为数据保留单个入口，并统一数据流。</font><font style="vertical-align: inherit;">否则，我有多个数据源，这可能变得很难调试。</font></font></p>

<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用这种策略进行类型检查比较困难，但是您可以使用React的PropTypes为“按对象放置大型对象”设置“形状”或类型模板。</font><font style="vertical-align: inherit;">参见：</font></font><a href="https://github.com/facebook/react/blob/master/src/core/ReactPropTypes.js#L76-L91"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">https</font></font></a>
<font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : 
 </font><a href="https://github.com/facebook/react/blob/master/src/core/ReactPropTypes.js#L76-L91"><font style="vertical-align: inherit;">//github.com/facebook/react/blob/master/src/core/ReactPropTypes.js#L76-L91 </font></a></font><a href="http://facebook.github.io/react/docs/reusable-components.html#prop-validation"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">http://facebook.github.io/react/docs/reusable-components.html#prop -验证</font></font></a></p>

<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">请注意，您可能需要在商店本身中放置在商店之间关联数据的逻辑。</font><font style="vertical-align: inherit;">所以，你的</font></font><code>ArticleStore</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">实力</font></font><code>waitFor()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">的</font></font><code>UserStore</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，并且包括与每一个相关用户</font></font><code>Article</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">提供通过记录</font></font><code>getArticles()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">在您的视图中执行此操作听起来就像将逻辑推入视图层，这是您应尽可能避免的一种做法。</font></font></p>

<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">您可能也很想使用</font></font><code>transferPropsTo()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，并且许多人都喜欢这样做，但是我更喜欢保持所有内容的明确性，以提高可读性和可维护性。</font></font></p>

<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">FWIW，我的理解是David Nolen对其Om框架（在</font></font><a href="https://justin.harmonize.fm/development/2014/08/05/om-and-flux.html"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">某种程度上与Flux兼容</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）</font><font style="vertical-align: inherit;">采用了类似的方法，</font><font style="vertical-align: inherit;">在根节点上只有一个数据入口点-Flux中的等效方法是只有一个控制器视图听所有商店。</font><font style="vertical-align: inherit;">通过使用</font></font><code>shouldComponentUpdate()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">不可变的数据结构（可以通过引用将其与===进行比较）来</font><font style="vertical-align: inherit;">提高效率</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">对于不可变的数据结构，请查看David的</font></font><a href="http://swannodette.github.io/mori/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mori</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或Facebook的</font></font><a href="https://github.com/facebook/immutable-js"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">immutable-js</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">我对Om的有限了解主要来自</font></font><a href="http://swannodette.github.io/2013/12/17/the-future-of-javascript-mvcs/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">JavaScript MVC框架的未来</font></font></a></p></div><!----></div></div><!--]--></div></div></div><div class="c-block-comment"><!----></div></div><div class="c-aside"><div class="fixed-area"><div class="question-list"><p class="title">最新问答</p><div class="body"><!--[--><div class="a-list-item"><a href="/question/4376" class=""><div class="inner-item"><!----><span class="flex-1"><!----> HTML5 Drag &amp; Drop 拖动时更改图标/光标</span></div><div class="text-12 text-theme mt-4">5 <span>回答</span></div></a></div><div class="a-list-item"><a href="/question/4375" class=""><div class="inner-item"><!----><span class="flex-1"><!----> 如何完全卸载 Node.js，然后从头重新安装 (Mac OS X)</span></div><div class="text-12 text-theme mt-4">25 <span>回答</span></div></a></div><div class="a-list-item"><a href="/question/4342" class=""><div class="inner-item"><!----><span class="flex-1"><!----> MAC终端删除代理有效命令</span></div><div class="text-12 text-theme mt-4">1 <span>回答</span></div></a></div><div class="a-list-item"><a href="/question/4338" class=""><div class="inner-item"><!----><span class="flex-1"><!----> vue动态路由跳转同一地址不刷新页面</span></div><div class="text-12 text-theme mt-4">0 <span>回答</span></div></a></div><div class="a-list-item"><a href="/question/4336" class=""><div class="inner-item"><!----><span class="flex-1"><!----> NUXT引入tailwindcss报错Error: Expected an opening square bracket.</span></div><div class="text-12 text-theme mt-4">1 <span>回答</span></div></a></div><!--]--></div></div><div class="c-adsense side-adsense"><div class="ad-container"><!----></div></div></div></div></div></div><!--]--></main><div class="c-footer"><div class="common-footer-inner"><div class="logo-contract"><a href="/" class="inline-flex space-x-8 items-center"><div class="sub-logo"><svg t="1696732448231" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="6740" xmlns:xlink="http://www.w3.org/1999/xlink" width="30" height="30"><defs><linearGradient id="left-to-right"><stop offset="0" stop-color="#ed3da1"><animate dur="3s" attributeName="offset" fill="freeze" values="-1;2;0" repeatCount="indefinite"></animate></stop><stop offset="0" stop-color="#ffe9f6"><animate dur="3s" attributeName="offset" fill="freeze" values="-1;2;0" repeatCount="indefinite"></animate></stop></linearGradient></defs><path d="M105.321374 914.265136c-11.700669 0-17.551004-11.702475-17.551003-17.541972 0-5.870203 5.850335-17.551004 11.7097-17.551004 269.155125-111.194286 561.722425-169.684988 848.441196-181.3983v5.839497c23.410369 0 52.662042-5.839497 76.076024-5.839497v11.711506c-292.558269 29.251673-579.284266 87.756824-854.300562 175.535323-17.551004 17.541972-40.964985 23.403144-64.375355 29.244447zM772.382332 580.741882c-29.260704 0-58.514183-5.861172-76.054349-29.240835-17.55281-23.412175-35.123682-46.826157-35.123681-76.079636 0-81.917327 23.403144-157.984319 76.068798-222.350642 46.835188-64.377161 117.042815-111.168999 193.106195-140.433316 29.251673 0 52.654817 17.563647 64.368129 40.954148-5.862978 5.850335-11.711506 11.711506-17.563647 11.711506 29.251673 11.700669 40.952342 35.102007 40.952342 64.366324 5.862978 163.834654-99.459299 310.121916-245.753787 351.072451z m157.996963-374.484627c-11.702475 5.850335-29.273347 17.551004-40.954148 29.264316-5.870203 0-5.870203-5.850335-5.870203-11.711506-87.778499 52.665654-146.281844 146.294487-152.114116 245.742949 0 11.711506 5.832272 52.665654 23.38147 46.835188 29.284184-11.7097 52.662042-23.423013 70.225688-46.835188 19.503523-21.441593 39.00524-42.894024 58.506958-64.344648 35.121876-46.81532 58.535857-105.320471 70.216658-163.847297 11.700669-17.55281-5.848528-29.253479-23.392307-35.103814zM122.872378 288.185419l-64.366323 29.251673c-5.839497 5.839497-11.689832 5.839497-17.540167 5.839497-5.862978 0-5.862978-11.713313-5.862978-17.540166 0-17.551004 11.713313-29.264316 29.273347-35.114651 35.103813-29.264316 70.20582-52.654817 111.158163-70.216657 17.551004 5.850335 29.264316 23.403144 35.11465 40.952341 0 17.540166 0 17.540166-81.919133 204.812282-29.249866 58.505151-52.651204 122.873281-58.523213 187.237798 0 5.852141 5.872009 17.55281 5.872009 23.412176v5.841303c-1.959745 1.948907-3.910458 3.912264-5.872009 5.861172-5.830466 0-11.700669 0-11.700669-5.861172-29.253479 0-52.663848-17.55281-58.505152-46.804482 0-46.813513 11.711506-99.470137 29.251673-140.433316 23.413982-64.366323 58.517795-122.871475 93.619802-187.237798zM637.792126 282.326054c11.700669 157.984319-87.760436 298.417635-239.892614 339.380813-29.264316 0-58.515989-5.850335-76.07783-29.264316-23.401338-17.561841-35.092976-46.813513-35.092976-76.056155 0-81.926358 23.403144-157.99335 76.068798-222.359673 46.804482-64.355486 117.008497-111.159968 193.086327-140.433316 29.242642 0 52.665654 17.551004 64.368129 40.975823-5.852141 5.839497-11.702475 11.689832-17.55281 11.689832 17.551004 17.549197 35.092976 46.811707 35.092976 76.066992z m-81.908295-35.103814c-11.7097 5.850335-29.260704 17.551004-40.963179 29.251673-5.850335 0-5.850335-5.850335-5.850335-11.700669-87.769468 52.665654-146.272813 146.28365-152.135791 245.762818 0 11.680801 5.862978 52.663848 23.413982 46.793645 29.251673-11.702475 52.665654-23.403144 70.20582-46.793645a140273.571944 140273.571944 0 0 0 58.515989-64.366324c35.103813-46.826157 58.514183-105.320471 70.214852-163.84549 11.713313-17.551004-5.839497-29.253479-23.401338-35.102008zM23.414885 808.944665c269.155125-111.170806 561.711587-169.684988 848.437584-181.3983v5.859365c29.251673 0 52.665654-5.859366 76.068798-5.859365v11.711506c-292.558269 29.26251-579.287878 87.778499-854.302368 175.544354-23.413982 11.713313-40.954148 17.554616-64.36813 23.3905h-5.837691c-5.872009 0-11.702475-5.835885-11.702475-17.551003 3.903233-3.896009 7.804661-7.797436 11.704282-11.697057z" fill="url(#left-to-right)" p-id="6741" class="logo-path"></path></svg></div><img class="h-50" src="/logo.svg"></a><div class="contacts"><!--[--><a class="contact-item" href="mailto:yldiswinter@gmail.com"><i class="iconfont icon-youxiang"></i></a><a class="contact-item" href="https://github.com/WinterMain"><i class="iconfont icon-github"></i></a><!--]--></div></div><div class="nav-area"><div class="pr-20"><p class="label"><span class="z-1">导航</span></p></div><div class="nav-items"><!--[--><!--[--><a href="/question" class="nav-item">问答</a><!--]--><!--[--><a href="/blog" class="nav-item">博客</a><!--]--><!--[--><a href="/message" class="nav-item">留言</a><!--]--><!--[--><a class="nav-item" target="_blank" rel="noopener noreferrer" href="https://tools.winter100.com">工具箱</a><!--]--><!--]--></div></div><div class="donate-area"><div class="pr-20"><p class="label"><span class="z-1">打赏</span></p></div><div class="donate-list"><!--[--><div class="donate-item"><div class="c-common-qrcode"><canvas style="width:60px;height:60px;"></canvas></div><div class="ml-12"><div class="flex items-center mt-4"><img src="/images/btc.png" height="30" class="h-20"><span class="ml-8 text-primary font-w500 text-16 flex-1">BTC</span><!--[--><span class="c-copy el-tooltip__trigger el-tooltip__trigger"><i class="el-icon text-12" style=""><!--[--><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1024 1024"><path fill="currentColor" d="M768 832a128 128 0 0 1-128 128H192A128 128 0 0 1 64 832V384a128 128 0 0 1 128-128v64a64 64 0 0 0-64 64v448a64 64 0 0 0 64 64h448a64 64 0 0 0 64-64z"></path><path fill="currentColor" d="M384 128a64 64 0 0 0-64 64v448a64 64 0 0 0 64 64h448a64 64 0 0 0 64-64V192a64 64 0 0 0-64-64zm0-64h448a128 128 0 0 1 128 128v448a128 128 0 0 1-128 128H384a128 128 0 0 1-128-128V192A128 128 0 0 1 384 64"></path></svg><!--]--></i></span><!--teleport start--><!--teleport end--><!--]--></div><p class="mt-12 text-addr"><span class="">1Q6ZDFC3FueXY3JocmeMqgiSsGGtppbvz2</span></p></div></div><div class="donate-item"><div class="c-common-qrcode"><canvas style="width:60px;height:60px;"></canvas></div><div class="ml-12"><div class="flex items-center mt-4"><img src="/images/eth.png" height="30" class="h-20"><span class="ml-8 text-primary font-w500 text-16 flex-1">ETH</span><!--[--><span class="c-copy el-tooltip__trigger el-tooltip__trigger"><i class="el-icon text-12" style=""><!--[--><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1024 1024"><path fill="currentColor" d="M768 832a128 128 0 0 1-128 128H192A128 128 0 0 1 64 832V384a128 128 0 0 1 128-128v64a64 64 0 0 0-64 64v448a64 64 0 0 0 64 64h448a64 64 0 0 0 64-64z"></path><path fill="currentColor" d="M384 128a64 64 0 0 0-64 64v448a64 64 0 0 0 64 64h448a64 64 0 0 0 64-64V192a64 64 0 0 0-64-64zm0-64h448a128 128 0 0 1 128 128v448a128 128 0 0 1-128 128H384a128 128 0 0 1-128-128V192A128 128 0 0 1 384 64"></path></svg><!--]--></i></span><!--teleport start--><!--teleport end--><!--]--></div><p class="mt-12 text-addr"><span class="">0xff6FC30033269845d196cB48F6a0660598D218D8</span></p></div></div><!--]--></div></div><div class="flex-1 ml-20 flex justify-end xs:hidden"><div class="c-adsense mt-0"><div class="ad-container"><!----></div></div></div></div></div><!--v-if--><!--]--></section><!--]--></div><div id="teleports"></div><script type="application/json" data-nuxt-data="nuxt-app" data-ssr id="__NUXT_DATA__" data-src="/question/1297/_payload.json?e77a6ad3-63a8-427f-9459-00571a6cdc19">[{"state":1,"once":7,"_errors":8,"serverRendered":10,"path":11,"pinia":12,"prerenderedAt":43},["Reactive",2],{"$ssite-config":3},{"env":4,"name":5,"url":6},"production","Winter 100分","https://winter100.com/",["Set"],["ShallowReactive",9],{},true,"/question/1297",["Reactive",13],{"lang":14,"main":27},{"langOptions":15,"lang":17,"defaultLang":17},[16,20,23],{"val":17,"text":18,"icon":19},"zh_Hans_CN","简体中文","/images/cn.svg",{"val":21,"text":22,"icon":19},"zh_Hant_HK","繁体中文",{"val":24,"text":25,"icon":26},"en_US","English","/images/en.svg",{"category":28,"nav":29,"likes":30,"donateCoins":31},"browserplugin","all",[],[32,36,40],{"coin":33,"address":34,"icon":35},"BTC","1Q6ZDFC3FueXY3JocmeMqgiSsGGtppbvz2","/images/btc.png",{"coin":37,"address":38,"icon":39},"ETH","0xff6FC30033269845d196cB48F6a0660598D218D8","/images/eth.png",{"coin":41,"address":38,"icon":42},"CET","/images/cet.png",1729915268311]</script>
<script>window.__NUXT__={};window.__NUXT__.config={public:{MODE:"",NODE_ENV:"production",NAME:"winter100"},app:{baseURL:"/",buildId:"e77a6ad3-63a8-427f-9459-00571a6cdc19",buildAssetsDir:"/_nuxt/",cdnURL:""}}</script></body></html>