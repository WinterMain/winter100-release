<!DOCTYPE html><html  data-capo=""><head><meta charset="utf-8">
<meta name="viewport" content="width=device-width, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>Access-Control-Allow-Origin标头如何工作？ - Winter100</title>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-KZ1S1HBYLX"></script>
<link rel="stylesheet" type="text/css" href="/iconfont/iconfont.css?t=20240930">
<link rel="stylesheet" href="/_nuxt/entry.DrNe-4ui.css">
<link rel="stylesheet" href="/_nuxt/default.IGDD3AF_.css">
<link rel="stylesheet" href="/_nuxt/el-popper.K902zei-.css">
<link rel="stylesheet" href="/_nuxt/Donate.C61dBJSg.css">
<link rel="stylesheet" href="/_nuxt/Adsense.C3XXM3TO.css">
<link rel="stylesheet" href="/_nuxt/Main.DNckYZCw.css">
<link rel="stylesheet" href="/_nuxt/Discuss.DCbqPIzI.css">
<link rel="stylesheet" href="/_nuxt/NewList.B56uyASM.css">
<link rel="stylesheet" href="/_nuxt/useLoadImages.BFkK1imR.css">
<link rel="preload" as="fetch" crossorigin="anonymous" href="/question/413/_payload.json?a4e7ffa4-1106-4b54-8c76-c28eedce6141">
<script src="/_nuxt/xuoSwgeJ-legacy.js" nomodule crossorigin></script>
<script src="/_nuxt/BUrHG7Hw-legacy.js" nomodule crossorigin></script>
<link rel="icon" type="image/x-icon" href="/favicon.ico">
<script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());

gtag('config', 'G-KZ1S1HBYLX');
</script>
<meta property="og:title" content="Access-Control-Allow-Origin标头如何工作？ - Winter100">
<meta name="description" content="显然，我完全误解了它的语义。我想到了这样的事情：


客户端从http：// siteA- origin下载javascript代码MyCode.js 。...">
<meta property="og:description" content="显然，我完全误解了它的语义。我想到了这样的事情：


客户端从http：// siteA- origin下载javascript代码MyCode.js 。...">
<meta property="og:image" content>
<meta name="twitter:card" content="summary_large_image">
<script type="module" src="/_nuxt/BvB2M4kZ.js" crossorigin></script></head><body><div id="el-popper-container-1024"><!--teleport start anchor--><!--[--><div style="z-index:2001;position:absolute;left:0;top:0;width:120px;display:none;" class="el-popper is-light el-popover c-lang-legal-popover" tabindex="-1" aria-hidden="true"><!--[--><!--[--><!--[--><!--[--><!--v-if--><!--[--><div class="c-lang-legal-box"><div class="c-contain"><ul class="c-list"><!--[--><li class="item-list list-item-active"><img src="/images/cn.svg" class="mr-12"><div class="flex-shrink-0">简体中文</div></li><li class="item-list false"><img src="/images/cn.svg" class="mr-12"><div class="flex-shrink-0">繁体中文</div></li><li class="item-list false"><img src="/images/en.svg" class="mr-12"><div class="flex-shrink-0">English</div></li><!--]--></ul></div></div><!--]--><!--]--><span class="el-popper__arrow" style="position:absolute;" data-popper-arrow></span><!--]--><!--]--><!--]--></div><!--]--><!--teleport anchor--><!--teleport start anchor--><!--[--><!--v-if--><!--]--><!--teleport anchor--><!--teleport start anchor--><!--[--><!--v-if--><!--]--><!--teleport anchor--></div><div id="__nuxt"><!--[--><section class="el-container is-vertical l-home"><!--[--><div class="nuxt-loading-indicator" style="position:fixed;top:0;right:0;left:0;pointer-events:none;width:auto;height:3px;opacity:0;background:repeating-linear-gradient(to right,#00dc82 0%,#34cdfe 50%,#0047e1 100%);background-size:Infinity% auto;transform:scaleX(0%);transform-origin:left;transition:transform 0.1s, height 0.4s, opacity 0.4s;z-index:999999;"></div><!--[--><!----><!--]--><!--[--><!----><!--]--><div class="c-common-header"><header class="el-header c-common-header-inner" style=""><!--[--><a href="/" class="flex space-x-8 items-center"><div class="sub-logo"><svg t="1696732448231" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="6740" xmlns:xlink="http://www.w3.org/1999/xlink" width="30" height="30"><defs><linearGradient id="left-to-right"><stop offset="0" stop-color="#ed3da1"><animate dur="3s" attributeName="offset" fill="freeze" values="-1;2;0" repeatCount="indefinite"></animate></stop><stop offset="0" stop-color="#ffe9f6"><animate dur="3s" attributeName="offset" fill="freeze" values="-1;2;0" repeatCount="indefinite"></animate></stop></linearGradient></defs><path d="M105.321374 914.265136c-11.700669 0-17.551004-11.702475-17.551003-17.541972 0-5.870203 5.850335-17.551004 11.7097-17.551004 269.155125-111.194286 561.722425-169.684988 848.441196-181.3983v5.839497c23.410369 0 52.662042-5.839497 76.076024-5.839497v11.711506c-292.558269 29.251673-579.284266 87.756824-854.300562 175.535323-17.551004 17.541972-40.964985 23.403144-64.375355 29.244447zM772.382332 580.741882c-29.260704 0-58.514183-5.861172-76.054349-29.240835-17.55281-23.412175-35.123682-46.826157-35.123681-76.079636 0-81.917327 23.403144-157.984319 76.068798-222.350642 46.835188-64.377161 117.042815-111.168999 193.106195-140.433316 29.251673 0 52.654817 17.563647 64.368129 40.954148-5.862978 5.850335-11.711506 11.711506-17.563647 11.711506 29.251673 11.700669 40.952342 35.102007 40.952342 64.366324 5.862978 163.834654-99.459299 310.121916-245.753787 351.072451z m157.996963-374.484627c-11.702475 5.850335-29.273347 17.551004-40.954148 29.264316-5.870203 0-5.870203-5.850335-5.870203-11.711506-87.778499 52.665654-146.281844 146.294487-152.114116 245.742949 0 11.711506 5.832272 52.665654 23.38147 46.835188 29.284184-11.7097 52.662042-23.423013 70.225688-46.835188 19.503523-21.441593 39.00524-42.894024 58.506958-64.344648 35.121876-46.81532 58.535857-105.320471 70.216658-163.847297 11.700669-17.55281-5.848528-29.253479-23.392307-35.103814zM122.872378 288.185419l-64.366323 29.251673c-5.839497 5.839497-11.689832 5.839497-17.540167 5.839497-5.862978 0-5.862978-11.713313-5.862978-17.540166 0-17.551004 11.713313-29.264316 29.273347-35.114651 35.103813-29.264316 70.20582-52.654817 111.158163-70.216657 17.551004 5.850335 29.264316 23.403144 35.11465 40.952341 0 17.540166 0 17.540166-81.919133 204.812282-29.249866 58.505151-52.651204 122.873281-58.523213 187.237798 0 5.852141 5.872009 17.55281 5.872009 23.412176v5.841303c-1.959745 1.948907-3.910458 3.912264-5.872009 5.861172-5.830466 0-11.700669 0-11.700669-5.861172-29.253479 0-52.663848-17.55281-58.505152-46.804482 0-46.813513 11.711506-99.470137 29.251673-140.433316 23.413982-64.366323 58.517795-122.871475 93.619802-187.237798zM637.792126 282.326054c11.700669 157.984319-87.760436 298.417635-239.892614 339.380813-29.264316 0-58.515989-5.850335-76.07783-29.264316-23.401338-17.561841-35.092976-46.813513-35.092976-76.056155 0-81.926358 23.403144-157.99335 76.068798-222.359673 46.804482-64.355486 117.008497-111.159968 193.086327-140.433316 29.242642 0 52.665654 17.551004 64.368129 40.975823-5.852141 5.839497-11.702475 11.689832-17.55281 11.689832 17.551004 17.549197 35.092976 46.811707 35.092976 76.066992z m-81.908295-35.103814c-11.7097 5.850335-29.260704 17.551004-40.963179 29.251673-5.850335 0-5.850335-5.850335-5.850335-11.700669-87.769468 52.665654-146.272813 146.28365-152.135791 245.762818 0 11.680801 5.862978 52.663848 23.413982 46.793645 29.251673-11.702475 52.665654-23.403144 70.20582-46.793645a140273.571944 140273.571944 0 0 0 58.515989-64.366324c35.103813-46.826157 58.514183-105.320471 70.214852-163.84549 11.713313-17.551004-5.839497-29.253479-23.401338-35.102008zM23.414885 808.944665c269.155125-111.170806 561.711587-169.684988 848.437584-181.3983v5.859365c29.251673 0 52.665654-5.859366 76.068798-5.859365v11.711506c-292.558269 29.26251-579.287878 87.778499-854.302368 175.544354-23.413982 11.713313-40.954148 17.554616-64.36813 23.3905h-5.837691c-5.872009 0-11.702475-5.835885-11.702475-17.551003 3.903233-3.896009 7.804661-7.797436 11.704282-11.697057z" fill="url(#left-to-right)" p-id="6741" class="logo-path"></path></svg></div><img class="h-40" src="/logo.svg"></a><div class="nav-items"><!--[--><!--[--><a href="/" class="nav-item">首页</a><!--]--><!--[--><a href="/question" class="nav-item">问答</a><!--]--><!--[--><a href="/blog" class="nav-item">博客</a><!--]--><!--[--><a href="/about" class="nav-item">关于</a><!--]--><!--[--><a href="/message" class="nav-item">留言</a><!--]--><!--[--><a class="nav-item" target="_blank" rel="noopener noreferrer" href="https://tools.winter100.com">工具箱</a><!--]--><!--]--></div><div class="flex-1"></div><div class="c-lang-legal xs:hidden"><!--[--><span class="relative ml-32 inline-flex items-center cursor-pointer border-gray-06 border px-8 py-4 rounded-8 el-tooltip__trigger el-tooltip__trigger"><img src="/images/cn.svg" class="mr-8"> 简体中文 <i class="el-icon ml-4 text-12" style=""><!--[--><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1024 1024"><path fill="currentColor" d="m192 384 320 384 320-384z"></path></svg><!--]--></i></span><!--teleport start--><!--teleport end--><!--]--></div><i class="iconfont icon-caidan text-theme hover:opacity-70 text-28 hidden xs:block"></i><!--]--></header><!----></div><main class="l-default-home"><!--[--><div class="c-question-main"><div class="page-container pt-30 pb-60"><div class="c-outer"><div class="article-area"><h1 class="article-title">Access-Control-Allow-Origin标头如何工作？</h1><p class="article-meta" style="color:#8590a6;"><i class="iconfont icon-time text-12"></i><span>十三西里GO</span><span>发布于2020/03/09 23:53:12</span></p><div class="article-content code-content"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">显然，我完全误解了它的语义。</font><font style="vertical-align: inherit;">我想到了这样的事情：</font></font></p>

<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">客户端从http：// siteA- </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">origin</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">下载javascript代码MyCode.js </font><font style="vertical-align: inherit;">。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MyCode.js的响应标头包含</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Access-Control-Allow-Origin：http：// siteB</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，我认为这意味着MyCode.js被允许对站点B进行跨域引用。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">客户端触发了MyCode.js的某些功能，该功能继而向http：// siteB发出了请求，尽管这是跨域请求，但仍然可以。</font></font></li>
</ol>

<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">好吧，我错了。</font><font style="vertical-align: inherit;">它根本不像这样工作。</font><font style="vertical-align: inherit;">因此，我已经阅读了</font></font><a href="http://en.wikipedia.org/wiki/Cross-origin_resource_sharing"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">跨域资源共享，</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">并尝试阅读</font></font><a href="http://www.w3.org/TR/cors/."><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">w3c建议中的跨域资源共享</font></font></a></p>

<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">可以肯定的是-我仍然不明白我应该如何使用此标头。 </font></font></p>

<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">我对站点A和站点B都拥有完全控制权。如何使用此标头使从站点A下载的javascript代码能够访问站点B上的资源？</font></font></p>

<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">聚苯乙烯</font></font></p>

<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">我不想利用JSONP。</font></font></p></div></div><div class="mt-20"><div class="discuss-wrapper"><div class="discuss-list"><!--[--><div class="discuss-item"><div class="discuss-parent"><div class="discuss-meta"><span class="discuss-user">Gil小哥伽罗</span><span class="discuss-time">2020/03/09 23:53:12</span></div><div class="discuss-comment"><blockquote>
  <p>The Access-Control-Allow-Origin response header indicates whether the
  response can be shared with requesting code from the given origin.</p>
</blockquote>

<pre><code>Header type Response       header<font></font>
Forbidden header name      no<font></font>
</code></pre>

<blockquote>
  <p>A response that tells the browser to allow code from any origin to
  access a resource will include the following:</p>
</blockquote>

<pre><code>Access-Control-Allow-Origin: *
</code></pre>

<p>For more info, visit <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Access-Control-Allow-Origin" rel="nofollow noreferrer">here</a>....</p></div><!----></div></div><div class="discuss-item"><div class="discuss-parent"><div class="discuss-meta"><span class="discuss-user">Itachi伽罗</span><span class="discuss-time">2020/03/09 23:53:12</span></div><div class="discuss-comment"><p>Simply paste the following code in your web.config file.</p>

<p>Noted that, you have to paste the following code under <code>&lt;system.webServer&gt;</code> tag</p>

<pre><code>    &lt;httpProtocol&gt;  <font></font>
    &lt;customHeaders&gt;  <font></font>
     &lt;add name="Access-Control-Allow-Origin" value="*" /&gt;  <font></font>
     &lt;add name="Access-Control-Allow-Headers" value="Content-Type" /&gt;  <font></font>
     &lt;add name="Access-Control-Allow-Methods" value="GET, POST, PUT, DELETE, OPTIONS" /&gt;  <font></font>
    &lt;/customHeaders&gt;  <font></font>
  &lt;/httpProtocol&gt;  <font></font>
</code></pre></div><!----></div></div><div class="discuss-item"><div class="discuss-parent"><div class="discuss-meta"><span class="discuss-user">前端Eva</span><span class="discuss-time">2020/03/09 23:53:12</span></div><div class="discuss-comment"><p>If you are using PHP, try adding the following code at the beginning of the php file:</p>

<p>If you are using localhost, try this:</p>

<pre><code>header("Access-Control-Allow-Origin: *");
</code></pre>

<p>If you are using external domains such as server, try this:</p>

<pre><code>header("Access-Control-Allow-Origin: http://www.website.com");
</code></pre></div><!----></div></div><div class="discuss-item"><div class="discuss-parent"><div class="discuss-meta"><span class="discuss-user">Sam阳光</span><span class="discuss-time">2020/03/09 23:53:12</span></div><div class="discuss-comment"><p>If you want just to test a cross domain application in which the browser blocks your request, then you can just open your browser in unsafe mode and test your application without changing your code and without making your code unsafe.
From MAC OS you can do this from the terminal line:</p>

<pre><code>open -a Google\ Chrome --args --disable-web-security --user-data-dir
</code></pre></div><!----></div></div><div class="discuss-item"><div class="discuss-parent"><div class="discuss-meta"><span class="discuss-user">Tony斯丁</span><span class="discuss-time">2020/03/09 23:53:12</span></div><div class="discuss-comment"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">跨域资源共享- </font></font><code>CORS</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（AKA跨域AJAX请求）是大多数Web开发人员可能遇到的问题，根据Same-Origin-Policy，浏览器将客户端JavaScript限制在安全沙箱中，通常JS无法直接与远程服务器通信来自其他域。</font><font style="vertical-align: inherit;">过去，开发人员创建了许多棘手的方法来实现跨域资源请求，最常用的方法是：</font></font></p>

<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用Flash / Silverlight或服务器端作为“代理”与远程通信。 </font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">带有填充的JSON（</font></font><a href="http://en.wikipedia.org/wiki/JSONP" rel="nofollow noreferrer"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">JSONP</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">将远程服务器嵌入到iframe中，并通过fragment或window.name进行通信，请参见</font></font><a href="http://www.ibm.com/developerworks/library/wa-crossdomaincomm/#N10120" rel="nofollow noreferrer"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">此处</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font></li>
</ol>

<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">这些棘手的方式或多或少都存在一些问题，例如，如果开发人员简单地“评估”，JSONP可能会导致安全漏洞；以及上面的＃3，尽管它起作用了，但两个域之间应该建立严格的契约，既不灵活也不优雅恕我直言：）</font></font></p>

<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">W3C引入了跨域资源共享（CORS）作为标准解决方案，以提供安全，灵活和推荐的标准方式来解决此问题。 </font></font></p>

<p><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">机制</font></font></strong></p>

<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">从较高的层次上，我们可以简单地认为CORS是域A的客户端AJAX调用与域B上托管的页面之间的合同，典型的跨域请求/响应为：</font></font></p>

<p><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DomainA AJAX请求标头</font></font></strong></p>

<pre><code>Host DomainB.com<font></font>
User-Agent Mozilla/5.0 (Windows NT 6.1; WOW64; rv:2.0) Gecko/20100101 Firefox/4.0<font></font>
Accept text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8,application/json<font></font>
Accept-Language en-us;<font></font>
Accept-Encoding gzip, deflate<font></font>
Keep-Alive 115<font></font>
Origin http://DomainA.com <font></font>
</code></pre>

<p><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DomainB响应标头</font></font></strong></p>

<pre><code>Cache-Control private<font></font>
Content-Type application/json; charset=utf-8<font></font>
Access-Control-Allow-Origin DomainA.com<font></font>
Content-Length 87<font></font>
Proxy-Connection Keep-Alive<font></font>
Connection Keep-Alive<font></font>
</code></pre>

<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">我在上面标记的蓝色部分是核心事实，“ Origin”请求标头“指示跨域请求或预检请求的来源”，“ Access-Control-Allow-Origin”响应标头指示此页面允许远程请求DomainA（如果值为*，则表示允许来自任何域的远程请求）。</font></font></p>

<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">正如我上面提到的，W3建议浏览器在</font><font style="vertical-align: inherit;">提交实际的跨域HTTP请求之前</font><font style="vertical-align: inherit;">实现一个“ </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">预检请求</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ”，简而言之，它是一个HTTP </font></font><code>OPTIONS</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">请求：</font></font></p>

<pre><code>OPTIONS DomainB.com/foo.aspx HTTP/1.1
</code></pre>

<p>If foo.aspx supports OPTIONS HTTP verb, it might return response like below:</p>

<pre><code>HTTP/1.1 200 OK<font></font>
Date: Wed, 01 Mar 2011 15:38:19 GMT<font></font>
Access-Control-Allow-Origin: http://DomainA.com<font></font>
Access-Control-Allow-Methods: POST, GET, OPTIONS, HEAD<font></font>
Access-Control-Allow-Headers: X-Requested-With<font></font>
Access-Control-Max-Age: 1728000<font></font>
Connection: Keep-Alive<font></font>
Content-Type: application/json<font></font>
</code></pre>

<p>Only if the response contains "Access-Control-Allow-Origin" AND its value is "*" or contain the domain who submitted the CORS request, by satisfying this mandtory condition browser will submit the actual Cross-Domain request, and cache the result in "<strong>Preflight-Result-Cache</strong>".</p>

<p>I blogged about CORS three years ago: <a href="http://wayneye.com/Blog/Ajax-Cross-Origin-HTTP-request" rel="nofollow noreferrer">AJAX Cross-Origin HTTP request</a></p></div><!----></div></div><div class="discuss-item"><div class="discuss-parent"><div class="discuss-meta"><span class="discuss-user">番长神奇</span><span class="discuss-time">2020/03/09 23:53:12</span></div><div class="discuss-comment"><p><code>Access-Control-Allow-Origin</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是</font></font><a href="http://www.html5rocks.com/en/tutorials/cors/" rel="noreferrer"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CORS（跨源资源共享）标头</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font></p>

<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">当站点A尝试从站点B获取内容时，站点B可以发送</font></font><code>Access-Control-Allow-Origin</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">响应标头以告知浏览器某些原始来源可以访问此页面的内容。</font><font style="vertical-align: inherit;">（</font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">来源</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是</font></font><a href="https://stackoverflow.com/a/19542686/710446"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">域，再加上方案和端口号</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。）默认情况下，</font></font><a href="https://en.wikipedia.org/wiki/Same-origin_policy" rel="noreferrer"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">其他任何来源</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">都</font><a href="https://en.wikipedia.org/wiki/Same-origin_policy" rel="noreferrer"><font style="vertical-align: inherit;">无法访问</font></a><font style="vertical-align: inherit;">站点B的页面</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">使用</font></font><code>Access-Control-Allow-Origin</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">标头会打开一扇门，可以按特定的请求来源进行跨域访问。</font></font></p>

<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">对于站点B希望站点A可以访问的每个资源/页面，站点B应该为其页面提供响应头：</font></font></p>

<pre><code>Access-Control-Allow-Origin: http://siteA.com
</code></pre>

<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">现代浏览器不会完全阻止跨域请求。</font><font style="vertical-align: inherit;">如果站点A从站点B请求一个页面，则浏览器实际上将</font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在网络级别上</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">获取请求的页面</font><em><font style="vertical-align: inherit;">，</font></em><font style="vertical-align: inherit;">并检查响应头是否将站点A列为允许的请求者域。</font><font style="vertical-align: inherit;">如果网站B尚未指示允许网站A访问此页面，则浏览器将触发</font></font><code>XMLHttpRequest</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">的</font></font><code>error</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">事件，并拒绝对请求JavaScript代码的响应数据。</font></font></p>

<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">非简单请求</font></font></h1>

<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">什么发生在网络层面可以</font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">略微</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">比上述解释更加复杂。</font><font style="vertical-align: inherit;">如果该请求是</font></font><a href="http://www.html5rocks.com/en/tutorials/cors/#toc-handling-a-not-so-simple-request" rel="noreferrer"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">“非简单”请求</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，则浏览器首先发送一个无数据的“预检” OPTIONS请求，以验证服务器将接受该请求。</font><font style="vertical-align: inherit;">当一个（或两个）同时发生时，请求是不简单的：</font></font></p>

<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用GET或POST以外的HTTP动词（例如PUT，DELETE）</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用非简单的请求标头；</font><font style="vertical-align: inherit;">仅有的简单请求标头是：

</font></font><ul>
<li><code>Accept</code></li>
<li><code>Accept-Language</code></li>
<li><code>Content-Language</code></li>
<li><code>Content-Type</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（当它的值是这仅仅是简单的</font></font><code>application/x-www-form-urlencoded</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，</font></font><code>multipart/form-data</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或</font></font><code>text/plain</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）</font></font></li>
</ul></li>
</ul>

<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果服务器使用与</font><font style="vertical-align: inherit;">非简单动词和/或非简单头匹配的</font><font style="vertical-align: inherit;">适当响应头（</font></font><code>Access-Control-Allow-Headers</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">对于非简单头，</font></font><code>Access-Control-Allow-Methods</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">对于非简单动词）来</font><font style="vertical-align: inherit;">响应OPTIONS预检</font><font style="vertical-align: inherit;">，则浏览器将发送实际请求。</font></font></p>

<p>Supposing that Site A wants to send a PUT request for <code>/somePage</code>, with a non-simple <code>Content-Type</code> value of <code>application/json</code>, the browser would first send a preflight request:</p>

<pre><code>OPTIONS /somePage HTTP/1.1<font></font>
Origin: http://siteA.com<font></font>
Access-Control-Request-Method: PUT<font></font>
Access-Control-Request-Headers: Content-Type<font></font>
</code></pre>

<p>Note that <code>Access-Control-Request-Method</code> and <code>Access-Control-Request-Headers</code> are added by the browser automatically; you do not need to add them. This OPTIONS preflight gets the successful response headers:</p>

<pre><code>Access-Control-Allow-Origin: http://siteA.com<font></font>
Access-Control-Allow-Methods: GET, POST, PUT<font></font>
Access-Control-Allow-Headers: Content-Type<font></font>
</code></pre>

<p>When sending the actual request (after preflight is done), the behavior is identical to how a simple request is handled. In other words, a non-simple request whose preflight is successful is treated the same as a simple request (i.e., the server must still send <code>Access-Control-Allow-Origin</code> again for the actual response).</p>

<p>The browsers sends the actual request:</p>

<pre><code>PUT /somePage HTTP/1.1<font></font>
Origin: http://siteA.com<font></font>
Content-Type: application/json<font></font>
<font></font>
{ "myRequestContent": "JSON is so great" }<font></font>
</code></pre>

<p>And the server sends back an <code>Access-Control-Allow-Origin</code>, just as it would for a simple request:</p>

<pre><code>Access-Control-Allow-Origin: http://siteA.com
</code></pre>

<p>See <a href="https://stackoverflow.com/a/13400954/710446">Understanding XMLHttpRequest over CORS</a> for a little more information about non-simple requests.</p></div><!----></div></div><!--]--></div></div></div><div class="c-block-comment"><script>window.blockCommentOptions = {
    root: &#39;discuss-wrapper&#39;,
    lang: &#39;zh_Hans_CN&#39;,
    locale: {&quot;discussTip&quot;:&quot;您的回答将提交至区块链中，开启Web3的大门。&quot;,&quot;discussInputTitle&quot;:&quot;回答&quot;,&quot;discussInputCommentPlaceholder&quot;:&quot;请输入回答...&quot;,&quot;discussInputCommentTip&quot;:&quot;请输入回答&quot;,&quot;discussSubmitting&quot;:&quot;您的回答正提交至区块链中...&quot;,&quot;totalTitle&quot;:&quot;共[num]条回答&quot;},
  };</script><script async src="/assets/js/block-comment.js"></script></div></div><div class="c-aside"><div class="fixed-area"><div class="question-list"><p class="title">最新问答</p><div class="body"><!--[--><div class="a-list-item"><a href="/question/4376" class=""><div class="inner-item"><!----><span class="flex-1">HTML5 Drag &amp; Drop 拖动时更改图标/光标</span></div><div class="text-12 text-theme mt-4">5 <span>回答</span></div></a></div><div class="a-list-item"><a href="/question/4375" class=""><div class="inner-item"><!----><span class="flex-1">如何完全卸载 Node.js，然后从头重新安装 (Mac OS X)</span></div><div class="text-12 text-theme mt-4">25 <span>回答</span></div></a></div><div class="a-list-item"><a href="/question/4342" class=""><div class="inner-item"><!----><span class="flex-1">MAC终端删除代理有效命令</span></div><div class="text-12 text-theme mt-4">1 <span>回答</span></div></a></div><div class="a-list-item"><a href="/question/4338" class=""><div class="inner-item"><!----><span class="flex-1">vue动态路由跳转同一地址不刷新页面</span></div><div class="text-12 text-theme mt-4">0 <span>回答</span></div></a></div><div class="a-list-item"><a href="/question/4336" class=""><div class="inner-item"><!----><span class="flex-1">NUXT引入tailwindcss报错Error: Expected an opening square bracket.</span></div><div class="text-12 text-theme mt-4">1 <span>回答</span></div></a></div><!--]--></div></div><div class="c-adsense side-adsense"><div class="ad-container"><!--[--><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-9684175232031230" crossorigin="anonymous"></script><ins class="adsbygoogle" style="display:block;" data-ad-client="ca-pub-9684175232031230" data-ad-slot="2002754568" data-ad-format="auto" data-full-width-responsive="true"></ins><script> (adsbygoogle = window.adsbygoogle || []).push({}); </script><!--]--></div></div></div></div></div></div><!--]--></main><div class="c-footer"><div class="common-footer-inner"><div class="logo-contract"><a href="/" class="inline-flex space-x-8 items-center"><div class="sub-logo"><svg t="1696732448231" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="6740" xmlns:xlink="http://www.w3.org/1999/xlink" width="30" height="30"><defs><linearGradient id="left-to-right"><stop offset="0" stop-color="#ed3da1"><animate dur="3s" attributeName="offset" fill="freeze" values="-1;2;0" repeatCount="indefinite"></animate></stop><stop offset="0" stop-color="#ffe9f6"><animate dur="3s" attributeName="offset" fill="freeze" values="-1;2;0" repeatCount="indefinite"></animate></stop></linearGradient></defs><path d="M105.321374 914.265136c-11.700669 0-17.551004-11.702475-17.551003-17.541972 0-5.870203 5.850335-17.551004 11.7097-17.551004 269.155125-111.194286 561.722425-169.684988 848.441196-181.3983v5.839497c23.410369 0 52.662042-5.839497 76.076024-5.839497v11.711506c-292.558269 29.251673-579.284266 87.756824-854.300562 175.535323-17.551004 17.541972-40.964985 23.403144-64.375355 29.244447zM772.382332 580.741882c-29.260704 0-58.514183-5.861172-76.054349-29.240835-17.55281-23.412175-35.123682-46.826157-35.123681-76.079636 0-81.917327 23.403144-157.984319 76.068798-222.350642 46.835188-64.377161 117.042815-111.168999 193.106195-140.433316 29.251673 0 52.654817 17.563647 64.368129 40.954148-5.862978 5.850335-11.711506 11.711506-17.563647 11.711506 29.251673 11.700669 40.952342 35.102007 40.952342 64.366324 5.862978 163.834654-99.459299 310.121916-245.753787 351.072451z m157.996963-374.484627c-11.702475 5.850335-29.273347 17.551004-40.954148 29.264316-5.870203 0-5.870203-5.850335-5.870203-11.711506-87.778499 52.665654-146.281844 146.294487-152.114116 245.742949 0 11.711506 5.832272 52.665654 23.38147 46.835188 29.284184-11.7097 52.662042-23.423013 70.225688-46.835188 19.503523-21.441593 39.00524-42.894024 58.506958-64.344648 35.121876-46.81532 58.535857-105.320471 70.216658-163.847297 11.700669-17.55281-5.848528-29.253479-23.392307-35.103814zM122.872378 288.185419l-64.366323 29.251673c-5.839497 5.839497-11.689832 5.839497-17.540167 5.839497-5.862978 0-5.862978-11.713313-5.862978-17.540166 0-17.551004 11.713313-29.264316 29.273347-35.114651 35.103813-29.264316 70.20582-52.654817 111.158163-70.216657 17.551004 5.850335 29.264316 23.403144 35.11465 40.952341 0 17.540166 0 17.540166-81.919133 204.812282-29.249866 58.505151-52.651204 122.873281-58.523213 187.237798 0 5.852141 5.872009 17.55281 5.872009 23.412176v5.841303c-1.959745 1.948907-3.910458 3.912264-5.872009 5.861172-5.830466 0-11.700669 0-11.700669-5.861172-29.253479 0-52.663848-17.55281-58.505152-46.804482 0-46.813513 11.711506-99.470137 29.251673-140.433316 23.413982-64.366323 58.517795-122.871475 93.619802-187.237798zM637.792126 282.326054c11.700669 157.984319-87.760436 298.417635-239.892614 339.380813-29.264316 0-58.515989-5.850335-76.07783-29.264316-23.401338-17.561841-35.092976-46.813513-35.092976-76.056155 0-81.926358 23.403144-157.99335 76.068798-222.359673 46.804482-64.355486 117.008497-111.159968 193.086327-140.433316 29.242642 0 52.665654 17.551004 64.368129 40.975823-5.852141 5.839497-11.702475 11.689832-17.55281 11.689832 17.551004 17.549197 35.092976 46.811707 35.092976 76.066992z m-81.908295-35.103814c-11.7097 5.850335-29.260704 17.551004-40.963179 29.251673-5.850335 0-5.850335-5.850335-5.850335-11.700669-87.769468 52.665654-146.272813 146.28365-152.135791 245.762818 0 11.680801 5.862978 52.663848 23.413982 46.793645 29.251673-11.702475 52.665654-23.403144 70.20582-46.793645a140273.571944 140273.571944 0 0 0 58.515989-64.366324c35.103813-46.826157 58.514183-105.320471 70.214852-163.84549 11.713313-17.551004-5.839497-29.253479-23.401338-35.102008zM23.414885 808.944665c269.155125-111.170806 561.711587-169.684988 848.437584-181.3983v5.859365c29.251673 0 52.665654-5.859366 76.068798-5.859365v11.711506c-292.558269 29.26251-579.287878 87.778499-854.302368 175.544354-23.413982 11.713313-40.954148 17.554616-64.36813 23.3905h-5.837691c-5.872009 0-11.702475-5.835885-11.702475-17.551003 3.903233-3.896009 7.804661-7.797436 11.704282-11.697057z" fill="url(#left-to-right)" p-id="6741" class="logo-path"></path></svg></div><img class="h-50" src="/logo.svg"></a><div class="contacts"><!--[--><a class="contact-item" href="mailto:yldiswinter@gmail.com"><i class="iconfont icon-youxiang"></i></a><a class="contact-item" href="https://github.com/WinterMain"><i class="iconfont icon-github"></i></a><!--]--></div></div><div class="nav-area"><div class="pr-20"><p class="label"><span class="z-1">导航</span></p></div><div class="nav-items"><!--[--><!--[--><a href="/question" class="nav-item">问答</a><!--]--><!--[--><a href="/blog" class="nav-item">博客</a><!--]--><!--[--><a href="/message" class="nav-item">留言</a><!--]--><!--[--><a class="nav-item" target="_blank" rel="noopener noreferrer" href="https://tools.winter100.com">工具箱</a><!--]--><!--]--></div></div><div class="donate-area"><div class="pr-20"><p class="label"><span class="z-1">打赏</span></p></div><div class="donate-list"><!--[--><div class="donate-item"><div class="c-common-qrcode"><canvas style="width:60px;height:60px;"></canvas></div><div class="ml-12"><div class="flex items-center mt-4"><img src="/images/btc.png" height="30" class="h-20"><span class="ml-8 text-primary font-w500 text-16 flex-1">BTC</span><!--[--><span class="c-copy el-tooltip__trigger el-tooltip__trigger"><i class="el-icon text-12" style=""><!--[--><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1024 1024"><path fill="currentColor" d="M768 832a128 128 0 0 1-128 128H192A128 128 0 0 1 64 832V384a128 128 0 0 1 128-128v64a64 64 0 0 0-64 64v448a64 64 0 0 0 64 64h448a64 64 0 0 0 64-64z"></path><path fill="currentColor" d="M384 128a64 64 0 0 0-64 64v448a64 64 0 0 0 64 64h448a64 64 0 0 0 64-64V192a64 64 0 0 0-64-64zm0-64h448a128 128 0 0 1 128 128v448a128 128 0 0 1-128 128H384a128 128 0 0 1-128-128V192A128 128 0 0 1 384 64"></path></svg><!--]--></i></span><!--teleport start--><!--teleport end--><!--]--></div><p class="mt-12 text-addr"><span class="">1Q6ZDFC3FueXY3JocmeMqgiSsGGtppbvz2</span></p></div></div><div class="donate-item"><div class="c-common-qrcode"><canvas style="width:60px;height:60px;"></canvas></div><div class="ml-12"><div class="flex items-center mt-4"><img src="/images/eth.png" height="30" class="h-20"><span class="ml-8 text-primary font-w500 text-16 flex-1">ETH</span><!--[--><span class="c-copy el-tooltip__trigger el-tooltip__trigger"><i class="el-icon text-12" style=""><!--[--><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1024 1024"><path fill="currentColor" d="M768 832a128 128 0 0 1-128 128H192A128 128 0 0 1 64 832V384a128 128 0 0 1 128-128v64a64 64 0 0 0-64 64v448a64 64 0 0 0 64 64h448a64 64 0 0 0 64-64z"></path><path fill="currentColor" d="M384 128a64 64 0 0 0-64 64v448a64 64 0 0 0 64 64h448a64 64 0 0 0 64-64V192a64 64 0 0 0-64-64zm0-64h448a128 128 0 0 1 128 128v448a128 128 0 0 1-128 128H384a128 128 0 0 1-128-128V192A128 128 0 0 1 384 64"></path></svg><!--]--></i></span><!--teleport start--><!--teleport end--><!--]--></div><p class="mt-12 text-addr"><span class="">0xff6FC30033269845d196cB48F6a0660598D218D8</span></p></div></div><!--]--></div></div><div class="flex-1 ml-20 flex justify-end xs:hidden"><div class="c-adsense mt-0"><div class="ad-container"><!--[--><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-9684175232031230" crossorigin="anonymous"></script><ins class="adsbygoogle" style="display:block;width:180px;height:180px" data-ad-client="ca-pub-9684175232031230" data-ad-slot="6637798878"></ins><script> (adsbygoogle = window.adsbygoogle || []).push({}); </script><!--]--></div></div></div></div></div><!--v-if--><!--]--></section><!--]--></div><div id="teleports"></div><script type="application/json" data-nuxt-data="nuxt-app" data-ssr id="__NUXT_DATA__" data-src="/question/413/_payload.json?a4e7ffa4-1106-4b54-8c76-c28eedce6141">[{"state":1,"once":7,"_errors":8,"serverRendered":10,"path":11,"pinia":12,"prerenderedAt":43},["Reactive",2],{"$ssite-config":3},{"env":4,"name":5,"url":6},"production","Winter 100分","https://winter100.com/",["Set"],["ShallowReactive",9],{},true,"/question/413",["Reactive",13],{"lang":14,"main":27},{"langOptions":15,"lang":17,"defaultLang":17},[16,20,23],{"val":17,"text":18,"icon":19},"zh_Hans_CN","简体中文","/images/cn.svg",{"val":21,"text":22,"icon":19},"zh_Hant_HK","繁体中文",{"val":24,"text":25,"icon":26},"en_US","English","/images/en.svg",{"category":28,"nav":29,"likes":30,"donateCoins":31},"browserplugin","all",[],[32,36,40],{"coin":33,"address":34,"icon":35},"BTC","1Q6ZDFC3FueXY3JocmeMqgiSsGGtppbvz2","/images/btc.png",{"coin":37,"address":38,"icon":39},"ETH","0xff6FC30033269845d196cB48F6a0660598D218D8","/images/eth.png",{"coin":41,"address":38,"icon":42},"CET","/images/cet.png",1728924631321]</script>
<script>window.__NUXT__={};window.__NUXT__.config={public:{MODE:"",NODE_ENV:"production",NAME:"winter100"},app:{baseURL:"/",buildId:"a4e7ffa4-1106-4b54-8c76-c28eedce6141",buildAssetsDir:"/_nuxt/",cdnURL:""}}</script></body></html>