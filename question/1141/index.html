<!DOCTYPE html><html  data-capo=""><head><meta charset="utf-8">
<meta name="viewport" content="width=device-width, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>为什么使用JavaScript eval函数不是一个好主意？ - Winter100</title>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-KZ1S1HBYLX"></script>
<link rel="stylesheet" type="text/css" href="/iconfont/iconfont.css?t=20240930">
<link rel="stylesheet" href="/_nuxt/entry.FjTWphKN.css">
<link rel="stylesheet" href="/_nuxt/default.CerbM5oS.css">
<link rel="stylesheet" href="/_nuxt/Main.DNckYZCw.css">
<link rel="stylesheet" href="/_nuxt/Discuss.B5xG6lk2.css">
<link rel="stylesheet" href="/_nuxt/NewList.B56uyASM.css">
<link rel="stylesheet" href="/_nuxt/all.Be8c8_k3.css">
<link rel="preload" as="fetch" crossorigin="anonymous" href="/question/1141/_payload.json?e77a6ad3-63a8-427f-9459-00571a6cdc19">
<script src="/_nuxt/CrQvFcQD-legacy.js" nomodule crossorigin></script>
<script src="/_nuxt/CpJo3Ge4-legacy.js" nomodule crossorigin></script>
<link rel="icon" type="image/x-icon" href="/favicon.ico">
<script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());

gtag('config', 'G-KZ1S1HBYLX');
</script>
<meta property="og:title" content="为什么使用JavaScript eval函数不是一个好主意？ - Winter100">
<meta name="description" content="eval函数是一种动态生成代码的强大而简便的方法，那么有哪些警告？...">
<meta property="og:description" content="eval函数是一种动态生成代码的强大而简便的方法，那么有哪些警告？...">
<meta property="og:image" content>
<meta name="twitter:card" content="summary_large_image">
<script type="module" src="/_nuxt/-5XrV3z5.js" crossorigin></script></head><body><div id="el-popper-container-1024"><!--teleport start anchor--><!--[--><div style="z-index:2001;position:absolute;left:0;top:0;width:120px;display:none;" class="el-popper is-light el-popover c-lang-legal-popover" tabindex="-1" aria-hidden="true"><!--[--><!--[--><!--[--><!--[--><!--v-if--><!--[--><div class="c-lang-legal-box"><div class="c-contain"><ul class="c-list"><!--[--><li class="item-list list-item-active"><img src="/images/cn.svg" class="mr-12"><div class="flex-shrink-0">简体中文</div></li><li class="item-list false"><img src="/images/cn.svg" class="mr-12"><div class="flex-shrink-0">繁体中文</div></li><li class="item-list false"><img src="/images/en.svg" class="mr-12"><div class="flex-shrink-0">English</div></li><!--]--></ul></div></div><!--]--><!--]--><span class="el-popper__arrow" style="position:absolute;" data-popper-arrow></span><!--]--><!--]--><!--]--></div><!--]--><!--teleport anchor--><!--teleport start anchor--><!--[--><!--v-if--><!--]--><!--teleport anchor--><!--teleport start anchor--><!--[--><!--v-if--><!--]--><!--teleport anchor--></div><div id="__nuxt"><!--[--><section class="el-container is-vertical l-home"><!--[--><div class="nuxt-loading-indicator" style="position:fixed;top:0;right:0;left:0;pointer-events:none;width:auto;height:3px;opacity:0;background:repeating-linear-gradient(to right,#00dc82 0%,#34cdfe 50%,#0047e1 100%);background-size:Infinity% auto;transform:scaleX(0%);transform-origin:left;transition:transform 0.1s, height 0.4s, opacity 0.4s;z-index:999999;"></div><!--[--><!----><!--]--><!--[--><!----><!--]--><div class="c-common-header"><header class="el-header c-common-header-inner" style=""><!--[--><a href="/" class="flex space-x-8 items-center"><div class="sub-logo"><svg t="1696732448231" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="6740" xmlns:xlink="http://www.w3.org/1999/xlink" width="30" height="30"><defs><linearGradient id="left-to-right"><stop offset="0" stop-color="#ed3da1"><animate dur="3s" attributeName="offset" fill="freeze" values="-1;2;0" repeatCount="indefinite"></animate></stop><stop offset="0" stop-color="#ffe9f6"><animate dur="3s" attributeName="offset" fill="freeze" values="-1;2;0" repeatCount="indefinite"></animate></stop></linearGradient></defs><path d="M105.321374 914.265136c-11.700669 0-17.551004-11.702475-17.551003-17.541972 0-5.870203 5.850335-17.551004 11.7097-17.551004 269.155125-111.194286 561.722425-169.684988 848.441196-181.3983v5.839497c23.410369 0 52.662042-5.839497 76.076024-5.839497v11.711506c-292.558269 29.251673-579.284266 87.756824-854.300562 175.535323-17.551004 17.541972-40.964985 23.403144-64.375355 29.244447zM772.382332 580.741882c-29.260704 0-58.514183-5.861172-76.054349-29.240835-17.55281-23.412175-35.123682-46.826157-35.123681-76.079636 0-81.917327 23.403144-157.984319 76.068798-222.350642 46.835188-64.377161 117.042815-111.168999 193.106195-140.433316 29.251673 0 52.654817 17.563647 64.368129 40.954148-5.862978 5.850335-11.711506 11.711506-17.563647 11.711506 29.251673 11.700669 40.952342 35.102007 40.952342 64.366324 5.862978 163.834654-99.459299 310.121916-245.753787 351.072451z m157.996963-374.484627c-11.702475 5.850335-29.273347 17.551004-40.954148 29.264316-5.870203 0-5.870203-5.850335-5.870203-11.711506-87.778499 52.665654-146.281844 146.294487-152.114116 245.742949 0 11.711506 5.832272 52.665654 23.38147 46.835188 29.284184-11.7097 52.662042-23.423013 70.225688-46.835188 19.503523-21.441593 39.00524-42.894024 58.506958-64.344648 35.121876-46.81532 58.535857-105.320471 70.216658-163.847297 11.700669-17.55281-5.848528-29.253479-23.392307-35.103814zM122.872378 288.185419l-64.366323 29.251673c-5.839497 5.839497-11.689832 5.839497-17.540167 5.839497-5.862978 0-5.862978-11.713313-5.862978-17.540166 0-17.551004 11.713313-29.264316 29.273347-35.114651 35.103813-29.264316 70.20582-52.654817 111.158163-70.216657 17.551004 5.850335 29.264316 23.403144 35.11465 40.952341 0 17.540166 0 17.540166-81.919133 204.812282-29.249866 58.505151-52.651204 122.873281-58.523213 187.237798 0 5.852141 5.872009 17.55281 5.872009 23.412176v5.841303c-1.959745 1.948907-3.910458 3.912264-5.872009 5.861172-5.830466 0-11.700669 0-11.700669-5.861172-29.253479 0-52.663848-17.55281-58.505152-46.804482 0-46.813513 11.711506-99.470137 29.251673-140.433316 23.413982-64.366323 58.517795-122.871475 93.619802-187.237798zM637.792126 282.326054c11.700669 157.984319-87.760436 298.417635-239.892614 339.380813-29.264316 0-58.515989-5.850335-76.07783-29.264316-23.401338-17.561841-35.092976-46.813513-35.092976-76.056155 0-81.926358 23.403144-157.99335 76.068798-222.359673 46.804482-64.355486 117.008497-111.159968 193.086327-140.433316 29.242642 0 52.665654 17.551004 64.368129 40.975823-5.852141 5.839497-11.702475 11.689832-17.55281 11.689832 17.551004 17.549197 35.092976 46.811707 35.092976 76.066992z m-81.908295-35.103814c-11.7097 5.850335-29.260704 17.551004-40.963179 29.251673-5.850335 0-5.850335-5.850335-5.850335-11.700669-87.769468 52.665654-146.272813 146.28365-152.135791 245.762818 0 11.680801 5.862978 52.663848 23.413982 46.793645 29.251673-11.702475 52.665654-23.403144 70.20582-46.793645a140273.571944 140273.571944 0 0 0 58.515989-64.366324c35.103813-46.826157 58.514183-105.320471 70.214852-163.84549 11.713313-17.551004-5.839497-29.253479-23.401338-35.102008zM23.414885 808.944665c269.155125-111.170806 561.711587-169.684988 848.437584-181.3983v5.859365c29.251673 0 52.665654-5.859366 76.068798-5.859365v11.711506c-292.558269 29.26251-579.287878 87.778499-854.302368 175.544354-23.413982 11.713313-40.954148 17.554616-64.36813 23.3905h-5.837691c-5.872009 0-11.702475-5.835885-11.702475-17.551003 3.903233-3.896009 7.804661-7.797436 11.704282-11.697057z" fill="url(#left-to-right)" p-id="6741" class="logo-path"></path></svg></div><img class="h-40" src="/logo.svg"></a><div class="nav-items"><!--[--><!--[--><a href="/" class="nav-item">首页</a><!--]--><!--[--><a href="/question" class="nav-item active">问答</a><!--]--><!--[--><a href="/blog" class="nav-item">博客</a><!--]--><!--[--><a href="/about" class="nav-item">关于</a><!--]--><!--[--><a href="/message" class="nav-item">留言</a><!--]--><!--[--><a class="nav-item" target="_blank" rel="noopener noreferrer" href="https://tools.winter100.com">工具箱</a><!--]--><!--]--></div><div class="flex-1"></div><div class="c-lang-legal xs:hidden"><!--[--><span class="relative ml-32 inline-flex items-center cursor-pointer border-gray-06 border px-8 py-4 rounded-8 el-tooltip__trigger el-tooltip__trigger"><img src="/images/cn.svg" class="mr-8"> 简体中文 <i class="el-icon ml-4 text-12" style=""><!--[--><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1024 1024"><path fill="currentColor" d="m192 384 320 384 320-384z"></path></svg><!--]--></i></span><!--teleport start--><!--teleport end--><!--]--></div><i class="iconfont icon-caidan text-theme hover:opacity-70 text-28 hidden xs:block"></i><!--]--></header><!----></div><main class="l-default-home"><!--[--><div class="c-question-main"><div class="page-container pt-30 pb-60"><div class="c-outer"><div class="article-area"><h1 class="article-title">为什么使用JavaScript eval函数不是一个好主意？</h1><p class="article-meta" style="color:#8590a6;"><span>Sam梅</span><i class="iconfont icon-time text-12 ml-12"></i><span>2020-03-12</span></p><div class="article-content code-content"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">eval函数是一种动态生成代码的强大而简便的方法，那么有哪些警告？</font></font></p></div></div><div class="mt-20"><div class="discuss-wrapper"><div class="discuss-list"><!--[--><div class="discuss-item"><div class="discuss-parent"><div class="discuss-meta"><span class="discuss-user">Gil西里斯丁</span><span class="discuss-time">2020/03/12 16:03:03</span></div><div class="discuss-comment"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">垃圾收集</font></font></p>

<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">浏览器的垃圾收集不知道是否可以将已评估的代码从内存中删除，因此仅将其保存直到重新加载页面为止。</font><font style="vertical-align: inherit;">如果您的用户不久才出现在您的页面上，也不错，但这对于webapp来说可能是个问题。</font></font></p>

<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">这是演示问题的脚本</font></font></p>

<p><a href="https://jsfiddle.net/CynderRnAsh/qux1osnw/" rel="nofollow noreferrer"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">https://jsfiddle.net/CynderRnAsh/qux1osnw/</font></font></a></p>

<pre><code>document.getElementById("evalLeak").onclick = (e) =&gt; {<font></font>
  for(let x = 0; x &lt; 100; x++) {<font></font>
    eval(x.toString());<font></font>
  }<font></font>
};<font></font>
</code></pre>

<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">与上述代码一样简单的操作会导致少量内存被存储，直到应用程序终止。</font><font style="vertical-align: inherit;">当逃避的脚本是一个巨大的函数并按间隔调用时，情况更糟。</font></font></p></div><!----></div></div><div class="discuss-item"><div class="discuss-parent"><div class="discuss-meta"><span class="discuss-user">神奇Jim</span><span class="discuss-time">2020/03/12 16:03:03</span></div><div class="discuss-comment"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">我要说的是，如果您使用</font></font><code>eval()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在浏览器中运行的javascript </font><font style="vertical-align: inherit;">并没有关系</font><font style="vertical-align: inherit;">。*（caveat）</font></font></p>

<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">所有现代的浏览器都有一个开发人员控制台，您可以在其中执行任意JavaScript，并且任何半智能的开发人员都可以查看您的JS源并将所需的任何内容放入开发人员控制台中以完成所需的工作。</font></font></p>

<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">*只要您的服务器端点具有对用户提供的值的正确验证和清除，则在客户端javascript中解析和评估的内容无关紧要。</font></font></p>

<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">但是，如果您询问是否适合</font></font><code>eval()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在PHP中</font><font style="vertical-align: inherit;">使用</font><font style="vertical-align: inherit;">，答案是“ </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">否”</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，除非您</font><font style="vertical-align: inherit;">将可能传递给eval语句的任何值</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">列入白名单</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font></p></div><!----></div></div><div class="discuss-item"><div class="discuss-parent"><div class="discuss-meta"><span class="discuss-user">猿小小</span><span class="discuss-time">2020/03/12 16:03:03</span></div><div class="discuss-comment"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">除了在执行用户提交的代码时可能出现的安全问题外，大多数时候，还有一种更好的方法，该方法无需每次执行代码都重新解析。</font><font style="vertical-align: inherit;">匿名函数或对象属性可以替代大多数eval用法，并且更加安全，快捷。</font></font></p></div><!----></div></div><div class="discuss-item"><div class="discuss-parent"><div class="discuss-meta"><span class="discuss-user">YOC66078158</span><span class="discuss-time">2020/03/12 16:03:03</span></div><div class="discuss-comment"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">JavaScript引擎在编译阶段执行了许多性能优化。</font><font style="vertical-align: inherit;">其中一些可以归结为能够在进行词法分析时基本静态地分析代码，并预先确定所有变量和函数声明的位置，从而在执行过程中花费较少的精力来解析标识符。</font></font></p>

<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">但是，如果引擎在代码中找到一个eval（..），则它实际上必须假定其对标识符位置的所有了解可能都是无效的，因为它无法在词法分析时确切地知道您可能传递给eval（..）的代码。修改词法范围，或您可能要传递给的对象的内容，以创建要查询的新词法范围。</font></font></p>

<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">换句话说，从悲观的意义上讲，如果存在eval（..），它将进行的大多数优化都是毫无意义的，因此它根本不执行优化。</font></font></p>

<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">这说明了一切。</font></font></p>

<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">参考：</font></font></p>

<p><a href="https://github.com/getify/You-Dont-Know-JS/blob/master/scope%20&amp;%20closures/ch2.md#eval" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">https://github.com/getify/You-Dont-Know-JS/blob/master/scope%20&amp;%20closures/ch2.md#eval</font></font></a></p>

<p><a href="https://github.com/getify/You-Dont-Know-JS/blob/master/scope%20&amp;%20closures/ch2.md#performance" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">https://github.com/getify/You-Dont-Know-JS/blob/master/scope%20&amp;%20closures/ch2.md#performance</font></font></a></p></div><!----></div></div><div class="discuss-item"><div class="discuss-parent"><div class="discuss-meta"><span class="discuss-user">村村小小十三</span><span class="discuss-time">2020/03/12 16:03:03</span></div><div class="discuss-comment"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">eval（）非常强大，可用于执行JS语句或评估表达式。</font><font style="vertical-align: inherit;">但是问题不关乎eval（）的使用，而只是说一些您用eval（）运行的字符串如何受到恶意方的影响。</font><font style="vertical-align: inherit;">最后，您将运行恶意代码。</font><font style="vertical-align: inherit;">权力伴随着巨大的责任。</font><font style="vertical-align: inherit;">因此，明智地使用它就是您正在使用它。</font><font style="vertical-align: inherit;">这与eval（）函数关系不大，但是本文提供了相当不错的信息：</font></font><a href="http://blogs.popart.com/2009/07/javascript-injection-attacks/" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">http</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :
  </font><a href="http://blogs.popart.com/2009/07/javascript-injection-attacks/" rel="nofollow"><font style="vertical-align: inherit;">//blogs.popart.com/2009/07/javascript-injection-attacks/</font></a><font style="vertical-align: inherit;"> 
如果您正在寻找eval（）的基础知识在这里查看：</font><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/eval" rel="nofollow"><font style="vertical-align: inherit;">https</font></a><font style="vertical-align: inherit;"> : 
 </font></font><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/eval" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">//developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/eval</font></font></a></p></div><!----></div></div><div class="discuss-item"><div class="discuss-parent"><div class="discuss-meta"><span class="discuss-user">谷若汐</span><span class="discuss-time">2020/03/12 16:03:03</span></div><div class="discuss-comment"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">这是一篇有关eval以及它不是邪恶的好文章：</font><a href="http://www.nczonline.net/blog/2013/06/25/eval-isnt-evil-just-misunderstood/" rel="nofollow"><font style="vertical-align: inherit;">http</font></a><font style="vertical-align: inherit;"> :
 </font></font><a href="http://www.nczonline.net/blog/2013/06/25/eval-isnt-evil-just-misunderstood/" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">//www.nczonline.net/blog/2013/06/25/eval-isnt-evil-just-misunderstood/</font></font></a></p>

<blockquote>
  <p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">我并不是说您应该精疲力尽，并开始在任何地方使用eval（）。</font><font style="vertical-align: inherit;">实际上，运行eval（）的好用例很少。</font><font style="vertical-align: inherit;">绝对存在代码清晰度，可调试性和性能方面的问题，这些问题不容忽视。</font><font style="vertical-align: inherit;">但是当您遇到eval（）有意义的情况时，就不用担心使用它。</font><font style="vertical-align: inherit;">尝试先不要使用它，但是当适当使用eval（）时，不要让任何人吓到您认为您的代码更脆弱或更不安全。</font></font></p>
</blockquote></div><!----></div></div><div class="discuss-item"><div class="discuss-parent"><div class="discuss-meta"><span class="discuss-user">达蒙小胖</span><span class="discuss-time">2020/03/12 16:03:03</span></div><div class="discuss-comment"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">随着下一代浏览器以某种JavaScript编译器的形式出现，这可能会成为一个更大的问题。</font><font style="vertical-align: inherit;">在这些较新的浏览器上，通过Eval执行的代码可能无法像其他JavaScript一样出色地运行。</font><font style="vertical-align: inherit;">有人应该做一些分析。</font></font></p></div><!----></div></div><div class="discuss-item"><div class="discuss-parent"><div class="discuss-meta"><span class="discuss-user">GO前端</span><span class="discuss-time">2020/03/12 16:03:03</span></div><div class="discuss-comment"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果您希望用户输入一些逻辑函数并求与与或，则JavaScript eval函数非常理想。</font><font style="vertical-align: inherit;">我可以接受两个字符串和</font></font><code>eval(uate) string1 === string2</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，等等。</font></font></p></div><!----></div></div><div class="discuss-item"><div class="discuss-parent"><div class="discuss-meta"><span class="discuss-user">神乐宝儿</span><span class="discuss-time">2020/03/12 16:03:03</span></div><div class="discuss-comment"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">这大大降低了您对安全性的信心。</font></font></p></div><!----></div></div><div class="discuss-item"><div class="discuss-parent"><div class="discuss-meta"><span class="discuss-user">蛋蛋Tom</span><span class="discuss-time">2020/03/12 16:03:03</span></div><div class="discuss-comment"><p>If you spot the use of eval() in your code, remember the mantra “eval() is evil.” </p>

<p>This
function takes an arbitrary string and executes it as JavaScript code. When the code in
question is known beforehand (not determined at runtime), there’s no reason to use
eval(). 
If the code is dynamically generated at runtime, there’s often a better way to
achieve the goal without eval(). 
For example, just using square bracket notation to
access dynamic properties is better and simpler:</p>

<pre><code>// antipattern<font></font>
var property = "name";<font></font>
alert(eval("obj." + property));<font></font>
<font></font>
// preferred<font></font>
var property = "name";<font></font>
alert(obj[property]);<font></font>
</code></pre>

<p>Using <code>eval()</code> also has security implications, because you might be executing code (for
example coming from the network) that has been tampered with. 
This is a common antipattern when dealing with a JSON response from an Ajax request. 
In those cases
it’s better to use the browsers’ built-in methods to parse the JSON response to make
sure it’s safe and valid. For browsers that don’t support <code>JSON.parse()</code> natively, you can
use a library from JSON.org.</p>

<p>It’s also important to remember that passing strings to <code>setInterval()</code>, <code>setTimeout()</code>,
and the <code>Function()</code> constructor is, for the most part, similar to using <code>eval()</code> and therefore
should be avoided. </p>

<p>Behind the scenes, JavaScript still has to evaluate and execute
the string you pass as programming code:</p>

<pre><code>// antipatterns<font></font>
setTimeout("myFunc()", 1000);<font></font>
setTimeout("myFunc(1, 2, 3)", 1000);<font></font>
<font></font>
// preferred<font></font>
setTimeout(myFunc, 1000);<font></font>
setTimeout(function () {<font></font>
myFunc(1, 2, 3);<font></font>
}, 1000);<font></font>
</code></pre>

<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用新的Function（）构造函数与eval（）相似，应谨慎使用。</font><font style="vertical-align: inherit;">它可能是一个强大的结构，但经常被滥用。</font><font style="vertical-align: inherit;">如果绝对必须使用</font></font><code>eval()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，则可以考虑使用new Function（）代替。</font></font></p>

<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">潜在的好处很小，因为在new Function（）中评估的代码将在局部函数范围内运行，因此在评估的代码中用var定义的任何变量都不会自动成为全局变量。 </font></font></p>

<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">防止自动全局变量的另一种方法是将</font></font><code>eval()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">调用</font><font style="vertical-align: inherit;">包装
 </font><font style="vertical-align: inherit;">到立即函数中。</font></font></p></div><!----></div></div><div class="discuss-item"><div class="discuss-parent"><div class="discuss-meta"><span class="discuss-user">理查德小宇宙</span><span class="discuss-time">2020/03/12 16:03:03</span></div><div class="discuss-comment"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">只要您知道使用它的上下文，并不一定很糟。</font></font></p>

<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果您的应用程序正在使用</font></font><code>eval()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">从</font></font><a href="http://en.wikipedia.org/wiki/XMLHttpRequest" rel="nofollow noreferrer"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">XMLHttpRequest</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回</font><font style="vertical-align: inherit;">到您自己的站点（由受信任的服务器端代码</font><font style="vertical-align: inherit;">创建）的JSON创建对象</font><font style="vertical-align: inherit;">，则可能不是问题。</font></font></p>

<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">无论如何，不​​受信任的客户端JavaScript代码不能做太多事情。</font><font style="vertical-align: inherit;">只要您执行的事情</font></font><code>eval()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">来自合理的来源，就可以了。</font></font></p></div><!----></div></div><div class="discuss-item"><div class="discuss-parent"><div class="discuss-meta"><span class="discuss-user">老丝猿Near</span><span class="discuss-time">2020/03/12 16:03:03</span></div><div class="discuss-comment"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">我知道这个讨论很古老，但是我真的很喜欢</font><font style="vertical-align: inherit;">Google的</font></font><a href="http://www.youtube.com/watch?feature=player_detailpage&amp;v=6EJ801el-I8#t=1729s" rel="noreferrer"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">这种</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">方法，并希望与他人分享这种感觉；）</font></font></p>

<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">另一件事是，您越了解越多，您就会尝试去理解，最终您只是不相信某事是好是坏，只是因为有人这么说:)这是一部非常鼓舞人心的</font></font><a href="http://www.youtube.com/watch?v=MFtijdklZDo" rel="noreferrer"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">视频</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，帮助我独自思考了更多:)好的做法很好，但是请不要轻率地使用它们:)</font></font></p></div><!----></div></div><div class="discuss-item"><div class="discuss-parent"><div class="discuss-meta"><span class="discuss-user">JinJin神奇宝儿</span><span class="discuss-time">2020/03/12 16:03:03</span></div><div class="discuss-comment"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">这可能会带来安全风险，执行范围不同，效率很低，因为它会为代码执行创建全新的脚本环境。</font><font style="vertical-align: inherit;">有关更多信息，请参见此处：</font></font><a href="http://userjs.org/help/tutorials/efficient-code#evalevil" rel="nofollow noreferrer"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">eval</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font></p>

<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">但是，它非常有用，并且适度使用可以增加很多良好的功能。</font></font></p></div><!----></div></div><div class="discuss-item"><div class="discuss-parent"><div class="discuss-meta"><span class="discuss-user">路易路易</span><span class="discuss-time">2020/03/12 16:03:03</span></div><div class="discuss-comment"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">除非您让eval（）动态内容（通过cgi或输入），否则它与页面中所有其他JavaScript一样安全可靠。</font></font></p></div><!----></div></div><div class="discuss-item"><div class="discuss-parent"><div class="discuss-meta"><span class="discuss-user">神乐路易</span><span class="discuss-time">2020/03/12 16:03:03</span></div><div class="discuss-comment"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">除了其他答案外，我认为eval语句无法实现高级最小化。</font></font></p></div><!----></div></div><div class="discuss-item"><div class="discuss-parent"><div class="discuss-meta"><span class="discuss-user">DavaidL</span><span class="discuss-time">2020/03/12 16:03:03</span></div><div class="discuss-comment"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">除非您100％确定要评估的代码来自受信任的来源（通常是您自己的应用程序），否则这是使您的系统遭受跨站点脚本攻击的肯定方式。</font></font></p></div><!----></div></div><div class="discuss-item"><div class="discuss-parent"><div class="discuss-meta"><span class="discuss-user">JinJin梅</span><span class="discuss-time">2020/03/12 16:03:03</span></div><div class="discuss-comment"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">主要是，它很难维护和调试。</font><font style="vertical-align: inherit;">就像一个</font></font><code>goto</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">您可以使用它，但是它使发现问题变得更加困难，并且使以后可能需要进行更改的人员变得更加困难。</font></font></p></div><!----></div></div><div class="discuss-item"><div class="discuss-parent"><div class="discuss-meta"><span class="discuss-user">→笑里藏刀↓</span><span class="discuss-time">2020/03/12 16:03:03</span></div><div class="discuss-comment"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">我相信这是因为它可以从字符串执行任何JavaScript函数。</font><font style="vertical-align: inherit;">使用它可以使人们更容易地将恶意代码注入应用程序。</font></font></p></div><!----></div></div><div class="discuss-item"><div class="discuss-parent"><div class="discuss-meta"><span class="discuss-user">Pro乐</span><span class="discuss-time">2020/03/12 16:03:03</span></div><div class="discuss-comment"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">我想到两点：</font></font></p>

<ol>
<li><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">安全性（但是，只要您生成要自己评估的字符串，就可能不是问题）</font></font></p></li>
<li><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">性能：除非要执行的代码未知，否则无法对其进行优化。</font><font style="vertical-align: inherit;">（关于javascript和性能，当然是</font></font><a href="http://steve-yegge.blogspot.com/2008/05/dynamic-languages-strike-back.html" rel="noreferrer"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Steve Yegge的介绍</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）</font></font></p></li>
</ol></div><!----></div></div><div class="discuss-item"><div class="discuss-parent"><div class="discuss-meta"><span class="discuss-user">ProTony</span><span class="discuss-time">2020/03/12 16:03:03</span></div><div class="discuss-comment"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果传递有效的用户输入，通常这只是一个问题。</font></font></p></div><!----></div></div><div class="discuss-item"><div class="discuss-parent"><div class="discuss-meta"><span class="discuss-user">十三村村蛋蛋</span><span class="discuss-time">2020/03/12 16:03:03</span></div><div class="discuss-comment"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">将用户输入传递给eval（）会带来安全风险，但是每次调用eval（）都会创建一个新的JavaScript解释器实例。</font><font style="vertical-align: inherit;">这可能是资源浪费。</font></font></p></div><!----></div></div><!--]--></div></div></div><div class="c-block-comment"><!----></div></div><div class="c-aside"><div class="fixed-area"><div class="question-list"><p class="title">最新问答</p><div class="body"><!--[--><div class="a-list-item"><a href="/question/4376" class=""><div class="inner-item"><!----><span class="flex-1"><!----> HTML5 Drag &amp; Drop 拖动时更改图标/光标</span></div><div class="text-12 text-theme mt-4">5 <span>回答</span></div></a></div><div class="a-list-item"><a href="/question/4375" class=""><div class="inner-item"><!----><span class="flex-1"><!----> 如何完全卸载 Node.js，然后从头重新安装 (Mac OS X)</span></div><div class="text-12 text-theme mt-4">25 <span>回答</span></div></a></div><div class="a-list-item"><a href="/question/4342" class=""><div class="inner-item"><!----><span class="flex-1"><!----> MAC终端删除代理有效命令</span></div><div class="text-12 text-theme mt-4">1 <span>回答</span></div></a></div><div class="a-list-item"><a href="/question/4338" class=""><div class="inner-item"><!----><span class="flex-1"><!----> vue动态路由跳转同一地址不刷新页面</span></div><div class="text-12 text-theme mt-4">0 <span>回答</span></div></a></div><div class="a-list-item"><a href="/question/4336" class=""><div class="inner-item"><!----><span class="flex-1"><!----> NUXT引入tailwindcss报错Error: Expected an opening square bracket.</span></div><div class="text-12 text-theme mt-4">1 <span>回答</span></div></a></div><!--]--></div></div><div class="c-adsense side-adsense"><div class="ad-container"><!----></div></div></div></div></div></div><!--]--></main><div class="c-footer"><div class="common-footer-inner"><div class="logo-contract"><a href="/" class="inline-flex space-x-8 items-center"><div class="sub-logo"><svg t="1696732448231" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="6740" xmlns:xlink="http://www.w3.org/1999/xlink" width="30" height="30"><defs><linearGradient id="left-to-right"><stop offset="0" stop-color="#ed3da1"><animate dur="3s" attributeName="offset" fill="freeze" values="-1;2;0" repeatCount="indefinite"></animate></stop><stop offset="0" stop-color="#ffe9f6"><animate dur="3s" attributeName="offset" fill="freeze" values="-1;2;0" repeatCount="indefinite"></animate></stop></linearGradient></defs><path d="M105.321374 914.265136c-11.700669 0-17.551004-11.702475-17.551003-17.541972 0-5.870203 5.850335-17.551004 11.7097-17.551004 269.155125-111.194286 561.722425-169.684988 848.441196-181.3983v5.839497c23.410369 0 52.662042-5.839497 76.076024-5.839497v11.711506c-292.558269 29.251673-579.284266 87.756824-854.300562 175.535323-17.551004 17.541972-40.964985 23.403144-64.375355 29.244447zM772.382332 580.741882c-29.260704 0-58.514183-5.861172-76.054349-29.240835-17.55281-23.412175-35.123682-46.826157-35.123681-76.079636 0-81.917327 23.403144-157.984319 76.068798-222.350642 46.835188-64.377161 117.042815-111.168999 193.106195-140.433316 29.251673 0 52.654817 17.563647 64.368129 40.954148-5.862978 5.850335-11.711506 11.711506-17.563647 11.711506 29.251673 11.700669 40.952342 35.102007 40.952342 64.366324 5.862978 163.834654-99.459299 310.121916-245.753787 351.072451z m157.996963-374.484627c-11.702475 5.850335-29.273347 17.551004-40.954148 29.264316-5.870203 0-5.870203-5.850335-5.870203-11.711506-87.778499 52.665654-146.281844 146.294487-152.114116 245.742949 0 11.711506 5.832272 52.665654 23.38147 46.835188 29.284184-11.7097 52.662042-23.423013 70.225688-46.835188 19.503523-21.441593 39.00524-42.894024 58.506958-64.344648 35.121876-46.81532 58.535857-105.320471 70.216658-163.847297 11.700669-17.55281-5.848528-29.253479-23.392307-35.103814zM122.872378 288.185419l-64.366323 29.251673c-5.839497 5.839497-11.689832 5.839497-17.540167 5.839497-5.862978 0-5.862978-11.713313-5.862978-17.540166 0-17.551004 11.713313-29.264316 29.273347-35.114651 35.103813-29.264316 70.20582-52.654817 111.158163-70.216657 17.551004 5.850335 29.264316 23.403144 35.11465 40.952341 0 17.540166 0 17.540166-81.919133 204.812282-29.249866 58.505151-52.651204 122.873281-58.523213 187.237798 0 5.852141 5.872009 17.55281 5.872009 23.412176v5.841303c-1.959745 1.948907-3.910458 3.912264-5.872009 5.861172-5.830466 0-11.700669 0-11.700669-5.861172-29.253479 0-52.663848-17.55281-58.505152-46.804482 0-46.813513 11.711506-99.470137 29.251673-140.433316 23.413982-64.366323 58.517795-122.871475 93.619802-187.237798zM637.792126 282.326054c11.700669 157.984319-87.760436 298.417635-239.892614 339.380813-29.264316 0-58.515989-5.850335-76.07783-29.264316-23.401338-17.561841-35.092976-46.813513-35.092976-76.056155 0-81.926358 23.403144-157.99335 76.068798-222.359673 46.804482-64.355486 117.008497-111.159968 193.086327-140.433316 29.242642 0 52.665654 17.551004 64.368129 40.975823-5.852141 5.839497-11.702475 11.689832-17.55281 11.689832 17.551004 17.549197 35.092976 46.811707 35.092976 76.066992z m-81.908295-35.103814c-11.7097 5.850335-29.260704 17.551004-40.963179 29.251673-5.850335 0-5.850335-5.850335-5.850335-11.700669-87.769468 52.665654-146.272813 146.28365-152.135791 245.762818 0 11.680801 5.862978 52.663848 23.413982 46.793645 29.251673-11.702475 52.665654-23.403144 70.20582-46.793645a140273.571944 140273.571944 0 0 0 58.515989-64.366324c35.103813-46.826157 58.514183-105.320471 70.214852-163.84549 11.713313-17.551004-5.839497-29.253479-23.401338-35.102008zM23.414885 808.944665c269.155125-111.170806 561.711587-169.684988 848.437584-181.3983v5.859365c29.251673 0 52.665654-5.859366 76.068798-5.859365v11.711506c-292.558269 29.26251-579.287878 87.778499-854.302368 175.544354-23.413982 11.713313-40.954148 17.554616-64.36813 23.3905h-5.837691c-5.872009 0-11.702475-5.835885-11.702475-17.551003 3.903233-3.896009 7.804661-7.797436 11.704282-11.697057z" fill="url(#left-to-right)" p-id="6741" class="logo-path"></path></svg></div><img class="h-50" src="/logo.svg"></a><div class="contacts"><!--[--><a class="contact-item" href="mailto:yldiswinter@gmail.com"><i class="iconfont icon-youxiang"></i></a><a class="contact-item" href="https://github.com/WinterMain"><i class="iconfont icon-github"></i></a><!--]--></div></div><div class="nav-area"><div class="pr-20"><p class="label"><span class="z-1">导航</span></p></div><div class="nav-items"><!--[--><!--[--><a href="/question" class="nav-item">问答</a><!--]--><!--[--><a href="/blog" class="nav-item">博客</a><!--]--><!--[--><a href="/message" class="nav-item">留言</a><!--]--><!--[--><a class="nav-item" target="_blank" rel="noopener noreferrer" href="https://tools.winter100.com">工具箱</a><!--]--><!--]--></div></div><div class="donate-area"><div class="pr-20"><p class="label"><span class="z-1">打赏</span></p></div><div class="donate-list"><!--[--><div class="donate-item"><div class="c-common-qrcode"><canvas style="width:60px;height:60px;"></canvas></div><div class="ml-12"><div class="flex items-center mt-4"><img src="/images/btc.png" height="30" class="h-20"><span class="ml-8 text-primary font-w500 text-16 flex-1">BTC</span><!--[--><span class="c-copy el-tooltip__trigger el-tooltip__trigger"><i class="el-icon text-12" style=""><!--[--><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1024 1024"><path fill="currentColor" d="M768 832a128 128 0 0 1-128 128H192A128 128 0 0 1 64 832V384a128 128 0 0 1 128-128v64a64 64 0 0 0-64 64v448a64 64 0 0 0 64 64h448a64 64 0 0 0 64-64z"></path><path fill="currentColor" d="M384 128a64 64 0 0 0-64 64v448a64 64 0 0 0 64 64h448a64 64 0 0 0 64-64V192a64 64 0 0 0-64-64zm0-64h448a128 128 0 0 1 128 128v448a128 128 0 0 1-128 128H384a128 128 0 0 1-128-128V192A128 128 0 0 1 384 64"></path></svg><!--]--></i></span><!--teleport start--><!--teleport end--><!--]--></div><p class="mt-12 text-addr"><span class="">1Q6ZDFC3FueXY3JocmeMqgiSsGGtppbvz2</span></p></div></div><div class="donate-item"><div class="c-common-qrcode"><canvas style="width:60px;height:60px;"></canvas></div><div class="ml-12"><div class="flex items-center mt-4"><img src="/images/eth.png" height="30" class="h-20"><span class="ml-8 text-primary font-w500 text-16 flex-1">ETH</span><!--[--><span class="c-copy el-tooltip__trigger el-tooltip__trigger"><i class="el-icon text-12" style=""><!--[--><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1024 1024"><path fill="currentColor" d="M768 832a128 128 0 0 1-128 128H192A128 128 0 0 1 64 832V384a128 128 0 0 1 128-128v64a64 64 0 0 0-64 64v448a64 64 0 0 0 64 64h448a64 64 0 0 0 64-64z"></path><path fill="currentColor" d="M384 128a64 64 0 0 0-64 64v448a64 64 0 0 0 64 64h448a64 64 0 0 0 64-64V192a64 64 0 0 0-64-64zm0-64h448a128 128 0 0 1 128 128v448a128 128 0 0 1-128 128H384a128 128 0 0 1-128-128V192A128 128 0 0 1 384 64"></path></svg><!--]--></i></span><!--teleport start--><!--teleport end--><!--]--></div><p class="mt-12 text-addr"><span class="">0xff6FC30033269845d196cB48F6a0660598D218D8</span></p></div></div><!--]--></div></div><div class="flex-1 ml-20 flex justify-end xs:hidden"><div class="c-adsense mt-0"><div class="ad-container"><!----></div></div></div></div></div><!--v-if--><!--]--></section><!--]--></div><div id="teleports"></div><script type="application/json" data-nuxt-data="nuxt-app" data-ssr id="__NUXT_DATA__" data-src="/question/1141/_payload.json?e77a6ad3-63a8-427f-9459-00571a6cdc19">[{"state":1,"once":7,"_errors":8,"serverRendered":10,"path":11,"pinia":12,"prerenderedAt":43},["Reactive",2],{"$ssite-config":3},{"env":4,"name":5,"url":6},"production","Winter 100分","https://winter100.com/",["Set"],["ShallowReactive",9],{},true,"/question/1141",["Reactive",13],{"lang":14,"main":27},{"langOptions":15,"lang":17,"defaultLang":17},[16,20,23],{"val":17,"text":18,"icon":19},"zh_Hans_CN","简体中文","/images/cn.svg",{"val":21,"text":22,"icon":19},"zh_Hant_HK","繁体中文",{"val":24,"text":25,"icon":26},"en_US","English","/images/en.svg",{"category":28,"nav":29,"likes":30,"donateCoins":31},"browserplugin","all",[],[32,36,40],{"coin":33,"address":34,"icon":35},"BTC","1Q6ZDFC3FueXY3JocmeMqgiSsGGtppbvz2","/images/btc.png",{"coin":37,"address":38,"icon":39},"ETH","0xff6FC30033269845d196cB48F6a0660598D218D8","/images/eth.png",{"coin":41,"address":38,"icon":42},"CET","/images/cet.png",1729915278243]</script>
<script>window.__NUXT__={};window.__NUXT__.config={public:{MODE:"",NODE_ENV:"production",NAME:"winter100"},app:{baseURL:"/",buildId:"e77a6ad3-63a8-427f-9459-00571a6cdc19",buildAssetsDir:"/_nuxt/",cdnURL:""}}</script></body></html>